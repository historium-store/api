<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:107,&quot;tests&quot;:90,&quot;passes&quot;:90,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2023-07-14T18:04:25.141Z&quot;,&quot;end&quot;:&quot;2023-07-14T18:04:39.939Z&quot;,&quot;duration&quot;:14798,&quot;testsRegistered&quot;:90,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;3b1c3b90-21b6-4042-bad5-ac6890d569f3&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e583f53e-6cd9-4c02-8a51-755fea1c07c2&quot;,&quot;title&quot;:&quot;auth system&quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\auth-test.js&quot;,&quot;file&quot;:&quot;\\test\\auth-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;fullTitle&quot;:&quot;auth system \&quot;before all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4426095-584e-4b96-93ec-33bf6d69ae34&quot;,&quot;parentUUID&quot;:&quot;e583f53e-6cd9-4c02-8a51-755fea1c07c2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;fullTitle&quot;:&quot;auth system \&quot;after all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c879b648-e60e-45ef-b565-002616549525&quot;,&quot;parentUUID&quot;:&quot;e583f53e-6cd9-4c02-8a51-755fea1c07c2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;cde4155c-8d6f-4489-8c97-067e48189254&quot;,&quot;title&quot;:&quot; \&quot;/signup\&quot; Create new user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\auth-test.js&quot;,&quot;file&quot;:&quot;\\test\\auth-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;The data should be validated and the body of the created user should be returned&quot;,&quot;fullTitle&quot;:&quot;auth system  \&quot;/signup\&quot; Create new user  The data should be validated and the body of the created user should be returned&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:303,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;firstName&#x27;,\n\t&#x27;lastName&#x27;,\n\t&#x27;phoneNumber&#x27;,\n\t&#x27;email&#x27;,\n\t&#x27;role&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;history&#x27;,\n\t&#x27;wishlist&#x27;,\n\t&#x27;waitlist&#x27;\n];\nawait request(app)\n\t.post(&#x27;/signup&#x27;)\n\t.send(adminUser)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;34a89fca-b464-42da-9234-50b72868517c&quot;,&quot;parentUUID&quot;:&quot;cde4155c-8d6f-4489-8c97-067e48189254&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;34a89fca-b464-42da-9234-50b72868517c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:303,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a19355cd-c43d-4ea9-853c-52739d007936&quot;,&quot;title&quot;:&quot; \&quot;/login\&quot; Login existing user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\auth-test.js&quot;,&quot;file&quot;:&quot;\\test\\auth-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;The password and login are correct, the token is returned&quot;,&quot;fullTitle&quot;:&quot;auth system  \&quot;/login\&quot; Login existing user  The password and login are correct, the token is returned&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:248,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const inputData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nawait request(app)\n\t.post(&#x27;/login&#x27;)\n\t.send(inputData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(&#x27;token&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cc66f4d0-9b49-4207-86e4-806b1d7109b3&quot;,&quot;parentUUID&quot;:&quot;a19355cd-c43d-4ea9-853c-52739d007936&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cc66f4d0-9b49-4207-86e4-806b1d7109b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:248,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f3bd57dd-0450-4357-a295-c86a8002b3e2&quot;,&quot;title&quot;:&quot; author system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;fullTitle&quot;:&quot; author system  \&quot;before all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:510,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b469409-9653-4291-8f3f-bad39557cdd6&quot;,&quot;parentUUID&quot;:&quot;f3bd57dd-0450-4357-a295-c86a8002b3e2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;fullTitle&quot;:&quot; author system  \&quot;after all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6dad5cef-5cd3-4959-896e-e60697857177&quot;,&quot;parentUUID&quot;:&quot;f3bd57dd-0450-4357-a295-c86a8002b3e2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a8af0ce5-a0b6-45f4-b3b0-41f898221e1a&quot;,&quot;title&quot;:&quot; POST \&quot;/author/\&quot; Create new author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Shoud create new author in database &quot;,&quot;fullTitle&quot;:&quot; author system   POST \&quot;/author/\&quot; Create new author   Shoud create new author in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newAuthor = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbiography:\n\t\t&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;biography&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;pictures&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/author/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newAuthor)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tauthorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c121f37d-af18-4995-bd68-1031910ec1f7&quot;,&quot;parentUUID&quot;:&quot;a8af0ce5-a0b6-45f4-b3b0-41f898221e1a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c121f37d-af18-4995-bd68-1031910ec1f7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f77afe4d-9cc7-4794-b873-8d38b66575f1&quot;,&quot;title&quot;:&quot; GET \&quot;/author/\&quot; Get all authors &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all authors &quot;,&quot;fullTitle&quot;:&quot; author system   GET \&quot;/author/\&quot; Get all authors   Should return all authors &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/author/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a5a28085-3dad-4b90-9a15-e4e2cd9d109b&quot;,&quot;parentUUID&quot;:&quot;f77afe4d-9cc7-4794-b873-8d38b66575f1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a5a28085-3dad-4b90-9a15-e4e2cd9d109b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7ff72e11-fda7-4f1c-81c3-3e28ae1a98f7&quot;,&quot;title&quot;:&quot; GET \&quot;/author/:id\&quot; Get one author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one author by id &quot;,&quot;fullTitle&quot;:&quot; author system   GET \&quot;/author/:id\&quot; Get one author   Should return one author by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;biography&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;pictures&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/author/${authorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee47bab8-52a8-4d12-9bc4-5ab11349b5d6&quot;,&quot;parentUUID&quot;:&quot;7ff72e11-fda7-4f1c-81c3-3e28ae1a98f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ee47bab8-52a8-4d12-9bc4-5ab11349b5d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;21031a32-7443-4833-8e4e-fd2aefd78dcc&quot;,&quot;title&quot;:&quot; PATCH \&quot;/author/:id\&quot; Update one existing author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one author with updated data &quot;,&quot;fullTitle&quot;:&quot; author system   PATCH \&quot;/author/:id\&quot; Update one existing author   Should return one author with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedAuthorData = {\n\tfullName: \&quot;Ім&#x27;ян Прізвиськов\&quot;,\n\tpictures: [&#x27;url-to-new-picture&#x27;, &#x27;url-to-another-new-picture&#x27;]\n};\nawait request(app)\n\t.patch(`/author/${authorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedAuthorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.equal(\n\t\t\t\&quot;Ім&#x27;ян Прізвиськов\&quot;\n\t\t);\n\t\texpect(response.body.pictures).to.includes(\n\t\t\t&#x27;url-to-new-picture&#x27;,\n\t\t\t&#x27;url-to-another-new-picture&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f3e343a-cc6a-48d7-9ab1-ba25d7c770ae&quot;,&quot;parentUUID&quot;:&quot;21031a32-7443-4833-8e4e-fd2aefd78dcc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5f3e343a-cc6a-48d7-9ab1-ba25d7c770ae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8066d0f8-1e7c-42f7-b815-712bca70c6d1&quot;,&quot;title&quot;:&quot; DELETE \&quot;/author/:id\&quot; Delete one author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark author as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;fullTitle&quot;:&quot; author system   DELETE \&quot;/author/:id\&quot; Delete one author   Should mark author as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/author/${authorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst author = await mongoose.connection\n\t\t\t.collection(&#x27;authors&#x27;)\n\t\t\t.findOne({});\n\t\texpect(author.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2084823-a713-42b5-8634-067d436c61c8&quot;,&quot;parentUUID&quot;:&quot;8066d0f8-1e7c-42f7-b815-712bca70c6d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d2084823-a713-42b5-8634-067d436c61c8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;cdb6f921-4ba8-4423-aa33-386756e215be&quot;,&quot;title&quot;:&quot; banner system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;before all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a5c7207-7d9a-41ae-a7e9-172d0cbfaf30&quot;,&quot;parentUUID&quot;:&quot;cdb6f921-4ba8-4423-aa33-386756e215be&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;before each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userData = {\n\tlogin: &#x27;dobriy.edu@gmail.com&#x27;,\n\tpassword: &#x27;41424344&#x27;\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d8b3261-f935-4a77-b731-e94ae78fabf4&quot;,&quot;parentUUID&quot;:&quot;cdb6f921-4ba8-4423-aa33-386756e215be&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;after all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;banners&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2480bdb9-4250-4dcc-bdd6-8f4105988da4&quot;,&quot;parentUUID&quot;:&quot;cdb6f921-4ba8-4423-aa33-386756e215be&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;after each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;userToken = &#x27;Bearer &#x27;;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b27177e8-a02d-4819-be3e-70b907c3f9a1&quot;,&quot;parentUUID&quot;:&quot;cdb6f921-4ba8-4423-aa33-386756e215be&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;417992d1-40b9-4bd2-aa05-e4c26aa4aba7&quot;,&quot;title&quot;:&quot; \&quot;/banner/\&quot; POST request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; the banner data is correct; the new banner object is returned &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/\&quot; POST request   the banner data is correct; the new banner object is returned &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c0318c5-f451-429e-9472-c058e35f80d0&quot;,&quot;parentUUID&quot;:&quot;417992d1-40b9-4bd2-aa05-e4c26aa4aba7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3c0318c5-f451-429e-9472-c058e35f80d0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5cd0ed53-8fae-48bb-92ed-7a05c282057b&quot;,&quot;title&quot;:&quot; \&quot;/banner/\&quot; GET request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; should return an array of banners &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/\&quot; GET request   should return an array of banners &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;378289e6-1612-4122-b60f-577107e0d0e2&quot;,&quot;parentUUID&quot;:&quot;5cd0ed53-8fae-48bb-92ed-7a05c282057b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;378289e6-1612-4122-b60f-577107e0d0e2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;441c0ae1-3f8e-4dc9-99ce-ebc810a01767&quot;,&quot;title&quot;:&quot; \&quot;/banner/:id\&quot; GET request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; should return banner object&quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/:id\&quot; GET request   should return banner object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7787fc48-f06d-4062-b134-67d829a6cf08&quot;,&quot;parentUUID&quot;:&quot;441c0ae1-3f8e-4dc9-99ce-ebc810a01767&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7787fc48-f06d-4062-b134-67d829a6cf08&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d3a1801f-63e5-454c-9530-ded62a375e94&quot;,&quot;title&quot;:&quot; \&quot;/banner/:id\&quot; PATCH request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; correct values are sent; the changed banner object is returned &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/:id\&quot; PATCH request   correct values are sent; the changed banner object is returned &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b8a5f77c-37d2-40a2-b57f-3fe53172ad68&quot;,&quot;parentUUID&quot;:&quot;d3a1801f-63e5-454c-9530-ded62a375e94&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b8a5f77c-37d2-40a2-b57f-3fe53172ad68&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;53964120-2b95-4ecd-948a-ce80e50e8947&quot;,&quot;title&quot;:&quot; \&quot;/banner/:id\&quot; DELETE request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; should set the \&quot;deletedAt\&quot; field. the object must be removed from the database &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/:id\&quot; DELETE request   should set the \&quot;deletedAt\&quot; field. the object must be removed from the database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d09cd8a-9ce2-405c-a2fb-0149e5ab2fff&quot;,&quot;parentUUID&quot;:&quot;53964120-2b95-4ecd-948a-ce80e50e8947&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1d09cd8a-9ce2-405c-a2fb-0149e5ab2fff&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6d1d0381-fb0a-4de7-87cc-692fc8db6461&quot;,&quot;title&quot;:&quot; book-series system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;fullTitle&quot;:&quot; book-series system  \&quot;before all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:490,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e58a71ba-3c6b-4629-9112-de6e559715c7&quot;,&quot;parentUUID&quot;:&quot;6d1d0381-fb0a-4de7-87cc-692fc8db6461&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;fullTitle&quot;:&quot; book-series system  \&quot;after all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;bookseries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96ae4ada-a8f5-490a-bce9-e802fc7fec18&quot;,&quot;parentUUID&quot;:&quot;6d1d0381-fb0a-4de7-87cc-692fc8db6461&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;77bff9ed-f533-496c-9604-b4e6f1af9828&quot;,&quot;title&quot;:&quot; POST \&quot;/book-series/\&quot; Create new book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new book series in database &quot;,&quot;fullTitle&quot;:&quot; book-series system   POST \&quot;/book-series/\&quot; Create new book series   Should create new book series in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst Publisher = {\n\tname: &#x27;Новий Вік&#x27;,\n\tbooks: [],\n\tbookSeries: [],\n\tdescription:\n\t\t&#x27;Видавництво, спеціалізуючеся на публікації літератури різних жанрів&#x27;,\n\tlogo: &#x27;https://example.com/logo.png&#x27;\n};\nconst publisherId = (\n\tawait request(app)\n\t\t.post(&#x27;/publisher/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(Publisher)\n).body._id;\n//#endregion\nconst newBookSeries = {\n\tname: &#x27;Українська класика&#x27;,\n\tpublisher: publisherId,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/book-series/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newBookSeries)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tbookSeriesId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ecd890d8-1e34-45a1-b69a-c53b6c130faf&quot;,&quot;parentUUID&quot;:&quot;77bff9ed-f533-496c-9604-b4e6f1af9828&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ecd890d8-1e34-45a1-b69a-c53b6c130faf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:25,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;53522299-542f-4801-b8af-88ffd4ae031f&quot;,&quot;title&quot;:&quot; GET \&quot;/book-series/\&quot; Get all book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all book series &quot;,&quot;fullTitle&quot;:&quot; book-series system   GET \&quot;/book-series/\&quot; Get all book series   Should return all book series &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/book-series/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;82793e08-ae87-421a-a5a9-cd2efe12f3c6&quot;,&quot;parentUUID&quot;:&quot;53522299-542f-4801-b8af-88ffd4ae031f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;82793e08-ae87-421a-a5a9-cd2efe12f3c6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6ae4a946-0f26-4a1c-9991-546357998201&quot;,&quot;title&quot;:&quot; GET \&quot;/book-series/:id\&quot; Get one book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one book series by id &quot;,&quot;fullTitle&quot;:&quot; book-series system   GET \&quot;/book-series/:id\&quot; Get one book series   Should return one book series by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/book-series/${bookSeriesId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9cec37f5-7f40-47d9-9068-7c065306ab87&quot;,&quot;parentUUID&quot;:&quot;6ae4a946-0f26-4a1c-9991-546357998201&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9cec37f5-7f40-47d9-9068-7c065306ab87&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;433b183f-8267-4d77-a512-8c22f65f76a3&quot;,&quot;title&quot;:&quot; PATCH \&quot;/book-series/:id\&quot; Update one existing book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one book series with updated data &quot;,&quot;fullTitle&quot;:&quot; book-series system   PATCH \&quot;/book-series/:id\&quot; Update one existing book series   Should return one book series with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedBookSeries = {\n\tname: &#x27;Українська класика *updated&#x27;\n};\nawait request(app)\n\t.patch(`/book-series/${bookSeriesId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedBookSeries)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.name).to.equal(\n\t\t\t&#x27;Українська класика *updated&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a00bed2-e325-48ab-9b22-64c536bb5099&quot;,&quot;parentUUID&quot;:&quot;433b183f-8267-4d77-a512-8c22f65f76a3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6a00bed2-e325-48ab-9b22-64c536bb5099&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:17,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b5680b7a-f51b-4adf-97f7-9dfdc692f7f7&quot;,&quot;title&quot;:&quot; DELETE \&quot;/book-series/:id\&quot; Delete one book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark book series as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; book-series system   DELETE \&quot;/book-series/:id\&quot; Delete one book series   Should mark book series as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/book-series/${bookSeriesId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedBookSeries = await mongoose.connection\n\t\t\t.collection(&#x27;bookseries&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedBookSeries.deletedAt).to.not.be.null;\n\t\tconst publisher = await mongoose.connection\n\t\t\t.collection(&#x27;publishers&#x27;)\n\t\t\t.findOne({});\n\t\texpect(publisher.bookSeries).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a161f62-0be3-477a-964b-bb07569bdae4&quot;,&quot;parentUUID&quot;:&quot;b5680b7a-f51b-4adf-97f7-9dfdc692f7f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5a161f62-0be3-477a-964b-bb07569bdae4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;46d5f098-ea0d-493e-bf4a-a4400190eed6&quot;,&quot;title&quot;:&quot; boook system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;fullTitle&quot;:&quot; boook system  \&quot;before all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:473,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c65e1fa9-be8e-4c04-bf5b-517da2d13ff2&quot;,&quot;parentUUID&quot;:&quot;46d5f098-ea0d-493e-bf4a-a4400190eed6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;fullTitle&quot;:&quot; boook system  \&quot;after all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;books&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;bookseries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;compilers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;editors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;illustrators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;translators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a5b01e3-e875-404c-a358-fe372d21c8a2&quot;,&quot;parentUUID&quot;:&quot;46d5f098-ea0d-493e-bf4a-a4400190eed6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e63682be-dfaa-44c4-b69e-81e0e9d4fe33&quot;,&quot;title&quot;:&quot; POST \&quot;/book/\&quot; Create new book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new book to database &quot;,&quot;fullTitle&quot;:&quot; boook system   POST \&quot;/book/\&quot; Create new book   Should create new book to database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:73,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Комікси і графічні романи&#x27;,\n\tkey: &#x27;Komiksy i hrafichni romany&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst publisher = {\n\tname: &#x27;Новий Вік&#x27;,\n\tbooks: [],\n\tbookSeries: [],\n\tdescription:\n\t\t&#x27;Видавництво, спеціалізуючеся на публікації літератури різних жанрів&#x27;,\n\tlogo: &#x27;https://example.com/logo.png&#x27;\n};\nconst publisherId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;publishers&#x27;)\n\t\t.insertOne(publisher)\n).insertedId;\nconst author = {\n\tfullName: &#x27;Іван Сидоренко&#x27;,\n\tbiography: &#x27;Текст біографії автора на українській мові.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nconst authorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;authors&#x27;)\n\t\t.insertOne(author)\n).insertedId;\nconst authorName = (\n\tawait mongoose.connection.collection(&#x27;authors&#x27;).findOne({})\n).fullName;\nconst compiler = {\n\tfullName: &#x27;Іван Бойко&#x27;,\n\tbooks: []\n};\nconst compilerId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;compilers&#x27;)\n\t\t.insertOne(compiler)\n).insertedId;\nconst translator = {\n\tfullName: &#x27;Анна Мельник&#x27;,\n\tbooks: []\n};\nconst translatorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;translators&#x27;)\n\t\t.insertOne(translator)\n).insertedId;\nconst illustrator = {\n\tfullName: &#x27;Ірина Левченко&#x27;,\n\tbooks: []\n};\nconst illustratorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;illustrators&#x27;)\n\t\t.insertOne(illustrator)\n).insertedId;\nconst editor = {\n\tfullName: &#x27;Юлія Григоренко&#x27;,\n\tbooks: []\n};\nconst editorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;editors&#x27;)\n\t\t.insertOne(editor)\n).insertedId;\nconst bookSeries = {\n\tname: &#x27;Українська класика&#x27;,\n\tpublisher: publisherId,\n\tbooks: []\n};\nconst bookSeriesId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;bookseries&#x27;)\n\t\t.insertOne(bookSeries)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst productId = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product)\n).body._id;\n//#endregion\nconst expectedFields = [\n\t&#x27;product&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;languages&#x27;,\n\t&#x27;publishedIn&#x27;,\n\t&#x27;authors&#x27;,\n\t&#x27;compilers&#x27;,\n\t&#x27;translators&#x27;,\n\t&#x27;illustrators&#x27;,\n\t&#x27;editors&#x27;,\n\t&#x27;series&#x27;,\n\t&#x27;copies&#x27;,\n\t&#x27;isbns&#x27;,\n\t&#x27;firstPublishedIn&#x27;,\n\t&#x27;originalName&#x27;,\n\t&#x27;font&#x27;,\n\t&#x27;format&#x27;,\n\t&#x27;pages&#x27;,\n\t&#x27;weight&#x27;,\n\t&#x27;bindingType&#x27;,\n\t&#x27;paperType&#x27;,\n\t&#x27;illustrationsType&#x27;,\n\t&#x27;literaturePeriod&#x27;,\n\t&#x27;literatureCountry&#x27;,\n\t&#x27;foreignLiterature&#x27;,\n\t&#x27;timePeriod&#x27;,\n\t&#x27;suitableAge&#x27;,\n\t&#x27;packaging&#x27;,\n\t&#x27;occasion&#x27;,\n\t&#x27;style&#x27;,\n\t&#x27;suitableFor&#x27;\n];\nconst newBook = {\n\tproduct: productId,\n\ttype: &#x27;Паперова&#x27;,\n\tpublisher: publisherId,\n\tlanguages: [&#x27;Українська&#x27;],\n\tpublishedIn: &#x27;1980&#x27;,\n\tauthors: [authorId],\n\tcompilers: [compilerId],\n\ttranslators: [translatorId],\n\tillustrators: [illustratorId],\n\teditors: [editorId],\n\tseries: [bookSeriesId],\n\tcopies: 100,\n\tisbns: [&#x27;978-3-16-148410-0&#x27;],\n\tfirstPublishedIn: &#x27;1981&#x27;,\n\toriginalName: &#x27;Збірка українських поезій&#x27;,\n\tfont: &#x27;Arial&#x27;,\n\tformat: &#x27;135х205 мм&#x27;,\n\tpages: 180,\n\tweight: 300,\n\tbindingType: &#x27;Пришивна палітурка&#x27;,\n\tpaperType: &#x27;Глянцевий&#x27;,\n\tillustrationsType: [&#x27;Повнокольоровий&#x27;],\n\tliteraturePeriod: [&#x27;Постмодернізм&#x27;],\n\tliteratureCountry: [&#x27;Україна&#x27;],\n\tforeignLiterature: false,\n\ttimePeriod: [&#x27;1980-1990&#x27;],\n\tsuitableAge: [&#x27;12+&#x27;],\n\tpackaging: &#x27;У коробці&#x27;,\n\toccasion: [&#x27;Без приводу&#x27;],\n\tstyle: [&#x27;Сучасна поезія&#x27;],\n\tsuitableFor: [&#x27;Дорослих&#x27;]\n};\nawait request(app)\n\t.post(&#x27;/book/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newBook)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tbookId = response.body._id;\n\t\t//#region check data integrity\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;publishers&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;authors&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;compilers&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;translators&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;illustrators&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;editors&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;bookseries&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\t//#endregion\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1666fdbf-1b4d-4507-8a4f-a0afaa251675&quot;,&quot;parentUUID&quot;:&quot;e63682be-dfaa-44c4-b69e-81e0e9d4fe33&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1666fdbf-1b4d-4507-8a4f-a0afaa251675&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:73,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c967761a-9a28-4116-b898-c08377959b6f&quot;,&quot;title&quot;:&quot; GET \&quot;/book/\&quot; Get all books &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all books &quot;,&quot;fullTitle&quot;:&quot; boook system   GET \&quot;/book/\&quot; Get all books   Should return all books &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/book/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.result).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;05414381-eee3-4e0a-9901-bb16d0f4e714&quot;,&quot;parentUUID&quot;:&quot;c967761a-9a28-4116-b898-c08377959b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;05414381-eee3-4e0a-9901-bb16d0f4e714&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;947f7107-126e-4070-9625-3f9aa5317622&quot;,&quot;title&quot;:&quot; GET \&quot;/book/:id\&quot; Get one book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one book by id &quot;,&quot;fullTitle&quot;:&quot; boook system   GET \&quot;/book/:id\&quot; Get one book   Should return one book by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;product&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;languages&#x27;,\n\t&#x27;publishedIn&#x27;,\n\t&#x27;authors&#x27;,\n\t&#x27;compilers&#x27;,\n\t&#x27;translators&#x27;,\n\t&#x27;illustrators&#x27;,\n\t&#x27;editors&#x27;,\n\t&#x27;series&#x27;,\n\t&#x27;copies&#x27;,\n\t&#x27;isbns&#x27;,\n\t&#x27;firstPublishedIn&#x27;,\n\t&#x27;originalName&#x27;,\n\t&#x27;font&#x27;,\n\t&#x27;format&#x27;,\n\t&#x27;pages&#x27;,\n\t&#x27;weight&#x27;,\n\t&#x27;bindingType&#x27;,\n\t&#x27;paperType&#x27;,\n\t&#x27;illustrationsType&#x27;,\n\t&#x27;literaturePeriod&#x27;,\n\t&#x27;literatureCountry&#x27;,\n\t&#x27;foreignLiterature&#x27;,\n\t&#x27;timePeriod&#x27;,\n\t&#x27;suitableAge&#x27;,\n\t&#x27;packaging&#x27;,\n\t&#x27;occasion&#x27;,\n\t&#x27;style&#x27;,\n\t&#x27;suitableFor&#x27;\n];\nawait request(app)\n\t.get(`/book/${bookId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a114b20-329f-499d-92b1-448a3bbc9e14&quot;,&quot;parentUUID&quot;:&quot;947f7107-126e-4070-9625-3f9aa5317622&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9a114b20-329f-499d-92b1-448a3bbc9e14&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:14,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;49646e9a-5f0b-489c-87c5-f8c59962ab3f&quot;,&quot;title&quot;:&quot; PATCH \&quot;/book/:id\&quot; Update one existing book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return book with updated data &quot;,&quot;fullTitle&quot;:&quot; boook system   PATCH \&quot;/book/:id\&quot; Update one existing book   Should return book with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedBookData = {\n\tpublishedIn: &#x27;1982&#x27;,\n\tlanguages: [&#x27;English&#x27;]\n};\nawait request(app)\n\t.patch(`/book/${bookId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedBookData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.publishedIn).to.equal(1982);\n\t\texpect(response.body.languages).to.include(&#x27;English&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a088b619-ca70-4504-85c6-43ebe5372907&quot;,&quot;parentUUID&quot;:&quot;49646e9a-5f0b-489c-87c5-f8c59962ab3f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a088b619-ca70-4504-85c6-43ebe5372907&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:19,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3cac17bf-ba02-4262-a073-b5fa0d7febc6&quot;,&quot;title&quot;:&quot; DELETE \&quot;/book/:id\&quot; Delete one book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;fullTitle&quot;:&quot; boook system   DELETE \&quot;/book/:id\&quot; Delete one book   Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/book/${bookId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedBook = await mongoose.connection\n\t\t\t.collection(&#x27;books&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedBook.deletedAt).to.not.be.null;\n\t\t//#region checking all dependencies\n\t\tconst author = await mongoose.connection\n\t\t\t.collection(&#x27;authors&#x27;)\n\t\t\t.findOne();\n\t\texpect(author.books).to.be.empty;\n\t\tconst compiler = await mongoose.connection\n\t\t\t.collection(&#x27;compilers&#x27;)\n\t\t\t.findOne();\n\t\texpect(compiler.books).to.be.empty;\n\t\tconst editor = await mongoose.connection\n\t\t\t.collection(&#x27;editors&#x27;)\n\t\t\t.findOne();\n\t\texpect(editor.books).to.be.empty;\n\t\tconst illustrator = await mongoose.connection\n\t\t\t.collection(&#x27;illustrators&#x27;)\n\t\t\t.findOne();\n\t\texpect(illustrator.books).to.be.empty;\n\t\tconst translator = await mongoose.connection\n\t\t\t.collection(&#x27;translators&#x27;)\n\t\t\t.findOne();\n\t\texpect(translator.books).to.be.empty;\n\t\tconst product = await mongoose.connection\n\t\t\t.collection(&#x27;products&#x27;)\n\t\t\t.findOne();\n\t\texpect(product.deletedAt).to.not.be.null;\n\t\tconst section = await mongoose.connection\n\t\t\t.collection(&#x27;sections&#x27;)\n\t\t\t.findOne();\n\t\texpect(section.products).to.be.empty;\n\t\t//#endregion\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36af6d5b-31f2-4aba-94b9-76f018663d81&quot;,&quot;parentUUID&quot;:&quot;3cac17bf-ba02-4262-a073-b5fa0d7febc6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;36af6d5b-31f2-4aba-94b9-76f018663d81&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:29,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;950ba1a5-b4c1-449e-8cb0-47e976ace17e&quot;,&quot;title&quot;:&quot; cart system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;fullTitle&quot;:&quot; cart system  \&quot;before all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:507,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6045ba47-eccb-434a-abf1-d51bafc90bec&quot;,&quot;parentUUID&quot;:&quot;950ba1a5-b4c1-449e-8cb0-47e976ace17e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;fullTitle&quot;:&quot; cart system  \&quot;after all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;cartitems&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d3f9758-0833-4425-9f57-72a3cd71ba40&quot;,&quot;parentUUID&quot;:&quot;950ba1a5-b4c1-449e-8cb0-47e976ace17e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;274f9485-6e1b-4b8b-aa31-ddc2fc5298ce&quot;,&quot;title&quot;:&quot; GET \&quot;/cart/\&quot; Get cart associated with user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return information about the cart of the authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   GET \&quot;/cart/\&quot; Get cart associated with user   Should return information about the cart of the authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [&#x27;items&#x27;, &#x27;totalPrice&#x27;, &#x27;totalQuantity&#x27;];\nawait request(app)\n\t.get(&#x27;/cart/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1c477d7-9f36-47b4-90d0-b14b776b9d10&quot;,&quot;parentUUID&quot;:&quot;274f9485-6e1b-4b8b-aa31-ddc2fc5298ce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b1c477d7-9f36-47b4-90d0-b14b776b9d10&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fcc08086-aac7-40e1-8330-4442d1804afd&quot;,&quot;title&quot;:&quot; DELETE \&quot;/cart/\&quot; Clear user cart &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should empty cart of the authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   DELETE \&quot;/cart/\&quot; Clear user cart   Should empty cart of the authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(&#x27;/cart/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cart.items).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3cc206b2-915f-4733-9dbc-8e83f01ef435&quot;,&quot;parentUUID&quot;:&quot;fcc08086-aac7-40e1-8330-4442d1804afd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3cc206b2-915f-4733-9dbc-8e83f01ef435&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4a0fa1e9-7354-4441-addc-4c04e7e10df1&quot;,&quot;title&quot;:&quot; POST \&quot;/cart-item/\&quot; Add item to user cart &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add the product to the cart of an authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   POST \&quot;/cart-item/\&quot; Add item to user cart   Should add the product to the cart of an authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tdeliveryPrice: 60,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tmodel: &#x27;Book&#x27;\n};\nproductId = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product)\n).body._id;\n//#endregion\nconst body = {\n\tproduct: productId.toString()\n};\nawait request(app)\n\t.post(&#x27;/cart-item/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(body)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cart.items).to.be.not.empty;\n\t\tconst cartItem = await mongoose.connection\n\t\t\t.collection(&#x27;cartitems&#x27;)\n\t\t\t.findOne({ _id: cart.items[0] });\n\t\texpect(cartItem.product.toString()).to.be.equal(productId);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32667576-13f2-4545-81d5-6a90f614356e&quot;,&quot;parentUUID&quot;:&quot;4a0fa1e9-7354-4441-addc-4c04e7e10df1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;32667576-13f2-4545-81d5-6a90f614356e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;40326d91-c17c-4693-b282-5ebfabb6dd19&quot;,&quot;title&quot;:&quot; DELETE \&quot;/cart-item/\&quot; Remove item from user cart &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should remove the product from the cart of an authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   DELETE \&quot;/cart-item/\&quot; Remove item from user cart   Should remove the product from the cart of an authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const body = {\n\tproduct: productId.toString()\n};\nawait request(app)\n\t.delete(&#x27;/cart-item/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(body)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cart.items).to.be.empty;\n\t\tconst cartItems = await mongoose.connection\n\t\t\t.collection(&#x27;cartitems&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cartItems).to.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;16bedbc5-6fa4-44f0-88f8-efd9cd3d6e60&quot;,&quot;parentUUID&quot;:&quot;40326d91-c17c-4693-b282-5ebfabb6dd19&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;16bedbc5-6fa4-44f0-88f8-efd9cd3d6e60&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2397fa3f-fdf9-455d-ac06-d0f9c41e7f2b&quot;,&quot;title&quot;:&quot; compiler system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;fullTitle&quot;:&quot; compiler system  \&quot;before all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:468,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;06f50c76-3762-4455-85df-889daa450be7&quot;,&quot;parentUUID&quot;:&quot;2397fa3f-fdf9-455d-ac06-d0f9c41e7f2b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;fullTitle&quot;:&quot; compiler system  \&quot;after all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;compilers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c565921-bb36-40ef-9257-3873b69c8eee&quot;,&quot;parentUUID&quot;:&quot;2397fa3f-fdf9-455d-ac06-d0f9c41e7f2b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;19b57b87-9fae-4ca5-b0f8-095029f29119&quot;,&quot;title&quot;:&quot; POST \&quot;/compiler/\&quot; Create new compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new compiler in database &quot;,&quot;fullTitle&quot;:&quot; compiler system   POST \&quot;/compiler/\&quot; Create new compiler   Should create new compiler in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newCompiler = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/compiler/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newCompiler)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tcompilerId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fddf189c-8ea7-47cf-b18b-9c6470fd5c9d&quot;,&quot;parentUUID&quot;:&quot;19b57b87-9fae-4ca5-b0f8-095029f29119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fddf189c-8ea7-47cf-b18b-9c6470fd5c9d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7acc2eb1-9e2b-4144-bc88-1eae0670b223&quot;,&quot;title&quot;:&quot; GET \&quot;/compiler/\&quot; Get all compilers &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all compilers &quot;,&quot;fullTitle&quot;:&quot; compiler system   GET \&quot;/compiler/\&quot; Get all compilers   Should return all compilers &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/compiler/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b9aa632-cf15-430a-8a67-4805743b1b10&quot;,&quot;parentUUID&quot;:&quot;7acc2eb1-9e2b-4144-bc88-1eae0670b223&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2b9aa632-cf15-430a-8a67-4805743b1b10&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8115adbd-9044-4333-a4bb-561c0dcecb09&quot;,&quot;title&quot;:&quot; GET \&quot;/compiler/:id\&quot; Get one compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one compiler by id &quot;,&quot;fullTitle&quot;:&quot; compiler system   GET \&quot;/compiler/:id\&quot; Get one compiler   Should return one compiler by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/compiler/${compilerId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9d8df4ad-10a6-4e65-bec4-35ac420802d6&quot;,&quot;parentUUID&quot;:&quot;8115adbd-9044-4333-a4bb-561c0dcecb09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9d8df4ad-10a6-4e65-bec4-35ac420802d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;23cb2595-3843-4a68-9fa7-f363c3a4f001&quot;,&quot;title&quot;:&quot; PATCH \&quot;/compiler/:id\&quot; Update one existing compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one compiler with updated data &quot;,&quot;fullTitle&quot;:&quot; compiler system   PATCH \&quot;/compiler/:id\&quot; Update one existing compiler   Should return one compiler with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedCompilerData = {\n\tfullName: &#x27;Updated compiler name&#x27;\n};\nawait request(app)\n\t.patch(`/compiler/${compilerId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedCompilerData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated compiler name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14f25646-2df7-4323-a71a-5e3d6af9492b&quot;,&quot;parentUUID&quot;:&quot;23cb2595-3843-4a68-9fa7-f363c3a4f001&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;14f25646-2df7-4323-a71a-5e3d6af9492b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1e845953-e0cc-467b-a378-fb4e83f9b151&quot;,&quot;title&quot;:&quot; DELETE \&quot;/compiler/:id\&quot; Delete one compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark compiler as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; compiler system   DELETE \&quot;/compiler/:id\&quot; Delete one compiler   Should mark compiler as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/compiler/${compilerId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedCompiler = await mongoose.connection\n\t\t\t.collection(&#x27;compilers&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedCompiler.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2e41595-f6b2-409a-94db-0427b01bffc2&quot;,&quot;parentUUID&quot;:&quot;1e845953-e0cc-467b-a378-fb4e83f9b151&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f2e41595-f6b2-409a-94db-0427b01bffc2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fa7add51-3186-41f2-ad73-d4b7f3c10f81&quot;,&quot;title&quot;:&quot; country system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\country-test.js&quot;,&quot;file&quot;:&quot;\\test\\country-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;fullTitle&quot;:&quot; country system  \&quot;before all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:476,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3f99a6c7-b8f2-40d7-9c63-2b88d716b4c4&quot;,&quot;parentUUID&quot;:&quot;fa7add51-3186-41f2-ad73-d4b7f3c10f81&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;fullTitle&quot;:&quot; country system  \&quot;after all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;countries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2577db36-3559-4a8a-b442-afd84c4ff99e&quot;,&quot;parentUUID&quot;:&quot;fa7add51-3186-41f2-ad73-d4b7f3c10f81&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1684369e-a202-4d66-bedf-061dbd82388e&quot;,&quot;title&quot;:&quot; GET \&quot;/country/\&quot; Get all countries &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\country-test.js&quot;,&quot;file&quot;:&quot;\\test\\country-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; GET \&quot;/country/\&quot; Get all countries \&quot;&quot;,&quot;fullTitle&quot;:&quot; country system   GET \&quot;/country/\&quot; Get all countries  \&quot;before all\&quot; hook in \&quot; GET \&quot;/country/\&quot; Get all countries \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const country = {\n\tname: &#x27;Україна&#x27;,\n\tcities: [&#x27;Одеса&#x27;, &#x27;Житомир&#x27;],\n\tkey: &#x27;ukraine&#x27;\n};\ncountryId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;countries&#x27;)\n\t\t.insertOne(country)\n).insertedId;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9eeb9c79-6ee0-40de-91e1-2739b235af9b&quot;,&quot;parentUUID&quot;:&quot;1684369e-a202-4d66-bedf-061dbd82388e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all countries &quot;,&quot;fullTitle&quot;:&quot; country system   GET \&quot;/country/\&quot; Get all countries   Should return all countries &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/country/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89e60bbb-7302-447c-9067-7c090c63a2fc&quot;,&quot;parentUUID&quot;:&quot;1684369e-a202-4d66-bedf-061dbd82388e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;89e60bbb-7302-447c-9067-7c090c63a2fc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b2a8ebb4-6e92-490e-af1e-21d487580114&quot;,&quot;title&quot;:&quot; GET \&quot;/country/:id\&quot; Get one country &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\country-test.js&quot;,&quot;file&quot;:&quot;\\test\\country-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one country by id &quot;,&quot;fullTitle&quot;:&quot; country system   GET \&quot;/country/:id\&quot; Get one country   Should return one country by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [&#x27;name&#x27;, &#x27;cities&#x27;];\nawait request(app)\n\t.get(`/country/${countryId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60221ddd-8216-48d0-b74a-1a589705e81b&quot;,&quot;parentUUID&quot;:&quot;b2a8ebb4-6e92-490e-af1e-21d487580114&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;60221ddd-8216-48d0-b74a-1a589705e81b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d63602aa-dcc6-45da-9d37-0fcd9d23bb69&quot;,&quot;title&quot;:&quot; delivery type system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\delivery-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\delivery-type-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; delivery type system  \&quot;before all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:464,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ffd71152-5d0d-408a-ace5-eea50ce8243a&quot;,&quot;parentUUID&quot;:&quot;d63602aa-dcc6-45da-9d37-0fcd9d23bb69&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; delivery type system  \&quot;after all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.deleteMany();\nawait mongoose.connection.collection(&#x27;countries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7147a5c1-44de-4366-b8d5-a90d6436fee2&quot;,&quot;parentUUID&quot;:&quot;d63602aa-dcc6-45da-9d37-0fcd9d23bb69&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;983b530d-e87d-4f4b-abf0-0599d4f6753b&quot;,&quot;title&quot;:&quot; GET \&quot;/delivery-type/\&quot; Get all delivery types &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\delivery-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\delivery-type-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; GET \&quot;/delivery-type/\&quot; Get all delivery types \&quot;&quot;,&quot;fullTitle&quot;:&quot; delivery type system   GET \&quot;/delivery-type/\&quot; Get all delivery types  \&quot;before all\&quot; hook in \&quot; GET \&quot;/delivery-type/\&quot; Get all delivery types \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const country = {\n\tname: &#x27;Україна&#x27;,\n\tcities: [&#x27;Одеса&#x27;, &#x27;Житомир&#x27;],\n\tkey: &#x27;ukraine&#x27;\n};\nconst countryId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;countries&#x27;)\n\t\t.insertOne(country)\n).insertedId;\nconst deliveryType = {\n\tname: &#x27;Відділення Нова Пошта&#x27;,\n\tprice: 60,\n\tcountries: [countryId],\n\tcontactInfoRequired: false,\n\tfullAddressRequired: false,\n\tpaymentTypes: [\n\t\t&#x27;Оплата карткою On-line&#x27;,\n\t\t&#x27;Готівкою або карткою: При отриманні&#x27;,\n\t\t&#x27;Передплата: по б/г рахунку (для юр. осіб)&#x27;\n\t],\n\tvariablePrice: false,\n\tkey: &#x27;viddilennya-nova-poshta&#x27;\n};\nawait mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.insertOne(deliveryType);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bb96dbd6-e1a5-44dc-b57b-b6c108eeab33&quot;,&quot;parentUUID&quot;:&quot;983b530d-e87d-4f4b-abf0-0599d4f6753b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all delivery types &quot;,&quot;fullTitle&quot;:&quot; delivery type system   GET \&quot;/delivery-type/\&quot; Get all delivery types   Should return all delivery types &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/delivery-type/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;).and.not.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55c02d9e-48fe-427e-b58c-00fc85cd2fb6&quot;,&quot;parentUUID&quot;:&quot;983b530d-e87d-4f4b-abf0-0599d4f6753b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;55c02d9e-48fe-427e-b58c-00fc85cd2fb6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ee2e9101-1de8-4d28-8188-7220aca88f2e&quot;,&quot;title&quot;:&quot; editor system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;fullTitle&quot;:&quot; editor system  \&quot;before all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:470,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e411a37-70dd-4ed5-b0ff-85ee22292dee&quot;,&quot;parentUUID&quot;:&quot;ee2e9101-1de8-4d28-8188-7220aca88f2e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;fullTitle&quot;:&quot; editor system  \&quot;after all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;editors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8d94628-b3fd-4491-aac6-4a80201b94a5&quot;,&quot;parentUUID&quot;:&quot;ee2e9101-1de8-4d28-8188-7220aca88f2e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e76d03bc-2f97-4afc-8dfd-a2118c7cf064&quot;,&quot;title&quot;:&quot; POST \&quot;/editor/\&quot; Create new editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new editor in database &quot;,&quot;fullTitle&quot;:&quot; editor system   POST \&quot;/editor/\&quot; Create new editor   Should create new editor in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newEditor = {\n\tfullName: &#x27;Anna Petrova&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/editor/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newEditor)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\teditorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ba07444-7054-43c7-934d-6f2f5572c4ba&quot;,&quot;parentUUID&quot;:&quot;e76d03bc-2f97-4afc-8dfd-a2118c7cf064&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3ba07444-7054-43c7-934d-6f2f5572c4ba&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;76caa362-49a1-4ecd-86ec-b1086b5cc05a&quot;,&quot;title&quot;:&quot; GET \&quot;/editor/\&quot; Get all editors &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all editors &quot;,&quot;fullTitle&quot;:&quot; editor system   GET \&quot;/editor/\&quot; Get all editors   Should return all editors &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/editor/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8946f16a-3742-4436-aa1c-35a8215b7b4c&quot;,&quot;parentUUID&quot;:&quot;76caa362-49a1-4ecd-86ec-b1086b5cc05a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8946f16a-3742-4436-aa1c-35a8215b7b4c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8dc8806c-6d23-4c4d-a6a8-2aa5c76443f5&quot;,&quot;title&quot;:&quot; GET \&quot;/editor/:id\&quot; Get one editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one editor by id  &quot;,&quot;fullTitle&quot;:&quot; editor system   GET \&quot;/editor/:id\&quot; Get one editor   Should return one editor by id  &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/editor/${editorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d98df749-2f84-42f1-9845-3056ea571ba3&quot;,&quot;parentUUID&quot;:&quot;8dc8806c-6d23-4c4d-a6a8-2aa5c76443f5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d98df749-2f84-42f1-9845-3056ea571ba3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a0bb5d1c-c386-4e6d-914e-9345982e6ed4&quot;,&quot;title&quot;:&quot; PATCH \&quot;/editor/:id\&quot; Update one existing editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one editor with updated data &quot;,&quot;fullTitle&quot;:&quot; editor system   PATCH \&quot;/editor/:id\&quot; Update one existing editor   Should return one editor with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedEditorData = {\n\tfullName: &#x27;Updated editor name&#x27;\n};\nawait request(app)\n\t.patch(`/editor/${editorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedEditorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated editor name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3bc46e20-7348-44ca-a7ca-e2e770169269&quot;,&quot;parentUUID&quot;:&quot;a0bb5d1c-c386-4e6d-914e-9345982e6ed4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3bc46e20-7348-44ca-a7ca-e2e770169269&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ba97e499-9580-4881-8e9d-67b8d4e4ec64&quot;,&quot;title&quot;:&quot; DELETE \&quot;/editor/:id\&quot; Delete one editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark editor as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; editor system   DELETE \&quot;/editor/:id\&quot; Delete one editor   Should mark editor as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/editor/${editorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedEditor = await mongoose.connection\n\t\t\t.collection(&#x27;editors&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedEditor.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9ad2d48d-835f-460b-a30d-bee7f0b837df&quot;,&quot;parentUUID&quot;:&quot;ba97e499-9580-4881-8e9d-67b8d4e4ec64&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9ad2d48d-835f-460b-a30d-bee7f0b837df&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;38a07917-a13b-437d-9afb-a1246c93bf90&quot;,&quot;title&quot;:&quot; illustrator system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; illustrator system  \&quot;before all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:489,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e20e44c5-519c-42d9-9fb4-07323d6a9e3a&quot;,&quot;parentUUID&quot;:&quot;38a07917-a13b-437d-9afb-a1246c93bf90&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; illustrator system  \&quot;after all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;illustrators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f4dbdea-74fe-4003-a6cf-4e3632a3a8fd&quot;,&quot;parentUUID&quot;:&quot;38a07917-a13b-437d-9afb-a1246c93bf90&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4a556801-a98b-46da-b584-6d097e2eb9ee&quot;,&quot;title&quot;:&quot; POST \&quot;/illustrator/\&quot; Create new illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Shold create new illustrator in database &quot;,&quot;fullTitle&quot;:&quot; illustrator system   POST \&quot;/illustrator/\&quot; Create new illustrator   Shold create new illustrator in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newIllustrator = {\n\tfullName: &#x27;Anna Petrova&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/illustrator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newIllustrator)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tillustratorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c7b8b82-0a95-4626-8af7-3e054cd01615&quot;,&quot;parentUUID&quot;:&quot;4a556801-a98b-46da-b584-6d097e2eb9ee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6c7b8b82-0a95-4626-8af7-3e054cd01615&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;090dfa3d-004e-4df4-8e02-440b397266df&quot;,&quot;title&quot;:&quot; GET \&quot;/illustrator/\&quot; Get all illustrators &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all illustrators &quot;,&quot;fullTitle&quot;:&quot; illustrator system   GET \&quot;/illustrator/\&quot; Get all illustrators   Should return all illustrators &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/illustrator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;80d872c9-2bfd-4fed-bf18-e8e0708e7a3f&quot;,&quot;parentUUID&quot;:&quot;090dfa3d-004e-4df4-8e02-440b397266df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;80d872c9-2bfd-4fed-bf18-e8e0708e7a3f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;878229fe-c030-4607-a28c-3304f60122ed&quot;,&quot;title&quot;:&quot; GET \&quot;/illustrator/:id\&quot; Get one illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one illustrator by id &quot;,&quot;fullTitle&quot;:&quot; illustrator system   GET \&quot;/illustrator/:id\&quot; Get one illustrator   Should return one illustrator by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/illustrator/${illustratorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a315217f-9309-44e4-b5e8-f8a4e1076d16&quot;,&quot;parentUUID&quot;:&quot;878229fe-c030-4607-a28c-3304f60122ed&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a315217f-9309-44e4-b5e8-f8a4e1076d16&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;bee3ee34-e83c-4855-bdae-b1679663eba5&quot;,&quot;title&quot;:&quot; PATCH \&quot;/illustrator/:id\&quot; Update one existing illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one illustrator with updated data &quot;,&quot;fullTitle&quot;:&quot; illustrator system   PATCH \&quot;/illustrator/:id\&quot; Update one existing illustrator   Should return one illustrator with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedIllustratorData = {\n\tfullName: &#x27;Updated illustrator name&#x27;\n};\nawait request(app)\n\t.patch(`/illustrator/${illustratorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedIllustratorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated illustrator name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;30b0099f-fe1a-47b7-9ee3-09cf9f273024&quot;,&quot;parentUUID&quot;:&quot;bee3ee34-e83c-4855-bdae-b1679663eba5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;30b0099f-fe1a-47b7-9ee3-09cf9f273024&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e0621f26-7873-460f-b195-5fea22187245&quot;,&quot;title&quot;:&quot; DELETE \&quot;/illustrator/:id\&quot; Delete one illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark illustrator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; illustrator system   DELETE \&quot;/illustrator/:id\&quot; Delete one illustrator   Should mark illustrator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/illustrator/${illustratorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedIllustrator = await mongoose.connection\n\t\t\t.collection(&#x27;illustrators&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedIllustrator.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2fdb2fe8-2245-43ed-a166-d5b1cf42d0c4&quot;,&quot;parentUUID&quot;:&quot;e0621f26-7873-460f-b195-5fea22187245&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2fdb2fe8-2245-43ed-a166-d5b1cf42d0c4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d873f64f-3a5e-4899-90f3-0fcb73754009&quot;,&quot;title&quot;:&quot; Order system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;fullTitle&quot;:&quot; Order system  \&quot;before all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:565,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;34eec2a5-a8b9-46b8-90c3-7174071a4c16&quot;,&quot;parentUUID&quot;:&quot;d873f64f-3a5e-4899-90f3-0fcb73754009&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;fullTitle&quot;:&quot; Order system  \&quot;after all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;countries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;cartitems&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;orders&#x27;).deleteMany();\nawait mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;54656fc8-ed4b-4015-992e-8788a4c9b462&quot;,&quot;parentUUID&quot;:&quot;d873f64f-3a5e-4899-90f3-0fcb73754009&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;7cdd7651-d4d2-43b6-8a1f-1fe9e9816db3&quot;,&quot;title&quot;:&quot; POST \&quot;/order/\&quot; Create new order &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; POST \&quot;/order/\&quot; Create new order \&quot;&quot;,&quot;fullTitle&quot;:&quot; Order system   POST \&quot;/order/\&quot; Create new order  \&quot;before all\&quot; hook in \&quot; POST \&quot;/order/\&quot; Create new order \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const country = {\n\tname: &#x27;Україна&#x27;,\n\tcities: [&#x27;Одеса&#x27;, &#x27;Житомир&#x27;],\n\tkey: &#x27;ukraine&#x27;\n};\nconst countryId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;countries&#x27;)\n\t\t.insertOne(country)\n).insertedId;\nconst deliveryType = {\n\tname: \&quot;Кур&#x27;єр Нова Пошта\&quot;,\n\tprice: 60,\n\tcountries: [countryId],\n\tcontactInfoRequired: false,\n\tfullAddressRequired: false,\n\tpaymentTypes: [\n\t\t&#x27;Оплата карткою On-line&#x27;,\n\t\t&#x27;Готівкою або карткою: При отриманні&#x27;,\n\t\t&#x27;Передплата: по б/г рахунку (для юр. осіб)&#x27;\n\t],\n\tvariablePrice: false,\n\tkey: &#x27;viddilennya-nova-poshta&#x27;\n};\nawait mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.insertOne(deliveryType);\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcode: &#x27;1023022&#x27;\n};\nproductId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;products&#x27;)\n\t\t.insertOne(product)\n).insertedId;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0f6ba1e-adfb-4110-bd20-d6a73cab42b4&quot;,&quot;parentUUID&quot;:&quot;7cdd7651-d4d2-43b6-8a1f-1fe9e9816db3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should register a new user and create an order. Also send 2 emails &quot;,&quot;fullTitle&quot;:&quot; Order system   POST \&quot;/order/\&quot; Create new order   Should register a new user and create an order. Also send 2 emails &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4146,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(10000);\nconst order = {\n\tcontactInfo: {\n\t\tfirstName: &#x27;Микола&#x27;,\n\t\tlastName: &#x27;Пшеничний&#x27;,\n\t\tphoneNumber: &#x27;+380687744321&#x27;,\n\t\temail: &#x27;jorobe6702@dronetz.com&#x27;\n\t},\n\tgift: false,\n\tcallback: true,\n\tdeliveryInfo: {\n\t\tcountry: &#x27;Україна&#x27;,\n\t\tcity: &#x27;Київ&#x27;,\n\t\ttype: \&quot;Кур&#x27;єр Нова Пошта\&quot;,\n\t\taddress: &#x27;вул. Шевченка, 10&#x27;\n\t},\n\tpaymentType: &#x27;Готівкою або карткою: При отриманні&#x27;,\n\titems: [{ product: productId, quantity: 3 }]\n};\nawait request(app)\n\t.post(&#x27;/order/&#x27;)\n\t.send(order)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(201);\n\t\tconst user = await mongoose.connection\n\t\t\t.collection(&#x27;users&#x27;)\n\t\t\t.findOne({ role: { $ne: &#x27;admin&#x27; } });\n\t\texpect(user).to.not.be.null;\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({ _id: user.cart });\n\t\texpect(cart).to.not.be.null;\n\t\tconst order = await mongoose.connection\n\t\t\t.collection(&#x27;orders&#x27;)\n\t\t\t.findOne({});\n\t\texpect(order).to.not.be.null;\n\t\texpect(order.user.toString()).to.be.equal(\n\t\t\tuser._id.toString()\n\t\t);\n\t\torderId = order._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;178228f9-9c9b-496c-945d-6918649055ec&quot;,&quot;parentUUID&quot;:&quot;7cdd7651-d4d2-43b6-8a1f-1fe9e9816db3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;178228f9-9c9b-496c-945d-6918649055ec&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4146,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7c4bf6d4-fe9a-45f8-9237-418ab2ac7d5d&quot;,&quot;title&quot;:&quot; GET \&quot;/order/\&quot; Get all orders &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all orders &quot;,&quot;fullTitle&quot;:&quot; Order system   GET \&quot;/order/\&quot; Get all orders   Should return all orders &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/order/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;).and.not.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a1951e2-c49b-43de-834c-7e5eab93372a&quot;,&quot;parentUUID&quot;:&quot;7c4bf6d4-fe9a-45f8-9237-418ab2ac7d5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6a1951e2-c49b-43de-834c-7e5eab93372a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:15,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1556d697-0e2f-46d6-98fa-7e39a0a5c2ce&quot;,&quot;title&quot;:&quot; GET \&quot;/order/statuses\&quot; Get all order statuses &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all order statuses&quot;,&quot;fullTitle&quot;:&quot; Order system   GET \&quot;/order/statuses\&quot; Get all order statuses   Should return all order statuses&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/order/statuses/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;).and.not.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31110e56-e326-4ae8-b64f-d7703fe42128&quot;,&quot;parentUUID&quot;:&quot;1556d697-0e2f-46d6-98fa-7e39a0a5c2ce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;31110e56-e326-4ae8-b64f-d7703fe42128&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;cae11599-e8c8-4f90-b2df-f70ea6a4e88c&quot;,&quot;title&quot;:&quot; GET \&quot;/order/:id\&quot; Get one order &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one order by id &quot;,&quot;fullTitle&quot;:&quot; Order system   GET \&quot;/order/:id\&quot; Get one order   Should return one order by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/order/${orderId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;object&#x27;).and.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31e10603-69ac-47bc-a837-b021bcba4490&quot;,&quot;parentUUID&quot;:&quot;cae11599-e8c8-4f90-b2df-f70ea6a4e88c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;31e10603-69ac-47bc-a837-b021bcba4490&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7be39740-77bf-4454-bb21-0a70bcbf65bd&quot;,&quot;title&quot;:&quot; PATCH \&quot;/order/status/:id\&quot; Update status of one existing order &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one order by id with updated status &quot;,&quot;fullTitle&quot;:&quot; Order system   PATCH \&quot;/order/status/:id\&quot; Update status of one existing order   Should return one order by id with updated status &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const status = await mongoose.connection\n\t.collection(&#x27;order_statuses&#x27;)\n\t.findOne({ name: &#x27;Виконаний&#x27; });\nawait request(app)\n\t.patch(`/order/status/${orderId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send({ status: status._id })\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\tconst order = await mongoose.connection\n\t\t\t.collection(&#x27;orders&#x27;)\n\t\t\t.findOne({});\n\t\texpect(order.status.name).to.be.equal(&#x27;Виконаний&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1dd9b39-3873-4666-8759-df5e3840ba3c&quot;,&quot;parentUUID&quot;:&quot;7be39740-77bf-4454-bb21-0a70bcbf65bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f1dd9b39-3873-4666-8759-df5e3840ba3c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;093c4d27-cb4c-41c8-94d5-423fd0ab80d2&quot;,&quot;title&quot;:&quot; product system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product system  \&quot;before all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:469,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ffc06d11-abb7-46d8-95df-aef93de4acdb&quot;,&quot;parentUUID&quot;:&quot;093c4d27-cb4c-41c8-94d5-423fd0ab80d2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product system  \&quot;after all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;books&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;bookseries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;compilers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;editors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;illustrators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;translators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dbc4495b-e150-4ab1-bf2e-c8f14fcf1ece&quot;,&quot;parentUUID&quot;:&quot;093c4d27-cb4c-41c8-94d5-423fd0ab80d2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c979d7d4-72bd-4ea5-8a24-d599a6a376fb&quot;,&quot;title&quot;:&quot; GET \&quot;/product/\&quot; Create new product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add new product to database. The value of the \&quot;currentProductsQuantity\&quot; property of the \&quot;products_quantity\&quot; collection should increase&quot;,&quot;fullTitle&quot;:&quot; product system   GET \&quot;/product/\&quot; Create new product   Should add new product to database. The value of the \&quot;currentProductsQuantity\&quot; property of the \&quot;products_quantity\&quot; collection should increase&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst author = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbiography:\n\t\t&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nawait mongoose.connection\n\t.collection(&#x27;authors&#x27;)\n\t.insertOne(author);\nconst authorName = (\n\tawait mongoose.connection.collection(&#x27;authors&#x27;).findOne({})\n).fullName;\n//#endregion\nconst oldProductsQuantity = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;products_quantity&#x27;)\n\t\t.findOne({})\n).currentProductsQuantity;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;key&#x27;,\n\t&#x27;price&#x27;,\n\t&#x27;quantity&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;sections&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;images&#x27;,\n\t&#x27;creators&#x27;,\n\t&#x27;requiresDelivery&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;code&#x27;\n];\nawait request(app)\n\t.post(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(product)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tconst newProductsQuantity = (\n\t\t\tawait mongoose.connection\n\t\t\t\t.collection(&#x27;products_quantity&#x27;)\n\t\t\t\t.findOne({})\n\t\t).currentProductsQuantity;\n\t\texpect(newProductsQuantity).to.be.above(\n\t\t\toldProductsQuantity\n\t\t);\n\t\tproductId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5404c46d-346a-49ed-a1a6-d20f087f79f7&quot;,&quot;parentUUID&quot;:&quot;c979d7d4-72bd-4ea5-8a24-d599a6a376fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5404c46d-346a-49ed-a1a6-d20f087f79f7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:19,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;edafdb56-62c3-4b1b-8d5c-bcb31c7e0080&quot;,&quot;title&quot;:&quot; GET \&quot;/product/\&quot; Get all products &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all products &quot;,&quot;fullTitle&quot;:&quot; product system   GET \&quot;/product/\&quot; Get all products   Should return all products &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.result).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a251fcff-1636-4494-86bb-0524bfff1595&quot;,&quot;parentUUID&quot;:&quot;edafdb56-62c3-4b1b-8d5c-bcb31c7e0080&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a251fcff-1636-4494-86bb-0524bfff1595&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;84448f96-cabb-4c46-82f4-1be7f53f629a&quot;,&quot;title&quot;:&quot; GET \&quot;/product/:id\&quot; Get one product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one product by id &quot;,&quot;fullTitle&quot;:&quot; product system   GET \&quot;/product/:id\&quot; Get one product   Should return one product by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;key&#x27;,\n\t&#x27;price&#x27;,\n\t&#x27;quantity&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;sections&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;images&#x27;,\n\t&#x27;creators&#x27;,\n\t&#x27;requiresDelivery&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;code&#x27;\n];\nawait request(app)\n\t.get(`/product/${productId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c7f8543-d2b1-48e5-852a-03a536d38043&quot;,&quot;parentUUID&quot;:&quot;84448f96-cabb-4c46-82f4-1be7f53f629a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4c7f8543-d2b1-48e5-852a-03a536d38043&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1c23f093-65ab-4c16-b305-285ec7df4d41&quot;,&quot;title&quot;:&quot; PATCH \&quot;/product/:id\&quot; Update one existing product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return product with updated data  &quot;,&quot;fullTitle&quot;:&quot; product system   PATCH \&quot;/product/:id\&quot; Update one existing product   Should return product with updated data  &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedProductData = {\n\tprice: 1000,\n\tquantity: 3\n};\nawait request(app)\n\t.patch(`/product/${productId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedProductData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.price).to.equal(\n\t\t\tupdatedProductData.price\n\t\t);\n\t\texpect(response.body.quantity).to.equal(\n\t\t\tupdatedProductData.quantity\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;34623d73-841e-4596-b2ed-3e2477ce5415&quot;,&quot;parentUUID&quot;:&quot;1c23f093-65ab-4c16-b305-285ec7df4d41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;34623d73-841e-4596-b2ed-3e2477ce5415&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ad339e20-0985-4df3-9160-f2762e7fbb34&quot;,&quot;title&quot;:&quot; DELETE \&quot;/prodcut/:id\&quot; Delete one product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; product system   DELETE \&quot;/prodcut/:id\&quot; Delete one product   Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region add necessary dependencies\nconst publisher = {\n\tname: &#x27;Квітка&#x27;,\n\tbooks: [],\n\tbookSeries: []\n};\nconst publisherId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;publishers&#x27;)\n\t\t.insertOne(publisher)\n).insertedId;\nconst book = {\n\tproduct: productId,\n\tpublisher: publisherId,\n\tlanguages: [&#x27;Українська&#x27;],\n\ttype: &#x27;Паперова&#x27;,\n\tpublishedIn: 1994\n};\nawait request(app)\n\t.post(&#x27;/book/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(book);\n//#endregion\nawait request(app)\n\t.delete(`/product/${productId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst product = await mongoose.connection\n\t\t\t.collection(&#x27;products&#x27;)\n\t\t\t.findOne({});\n\t\texpect(product.deletedAt).to.be.not.null;\n\t\tconst book = await mongoose.connection\n\t\t\t.collection(&#x27;books&#x27;)\n\t\t\t.findOne({});\n\t\texpect(book.deletedAt).to.be.not.null;\n\t\tconst section = await mongoose.connection\n\t\t\t.collection(&#x27;sections&#x27;)\n\t\t\t.findOne({});\n\t\texpect(section.products).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e296569-9dc7-4157-86de-3da6aaa44bc5&quot;,&quot;parentUUID&quot;:&quot;ad339e20-0985-4df3-9160-f2762e7fbb34&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0e296569-9dc7-4157-86de-3da6aaa44bc5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;91393306-e88e-4460-a1b1-334c73233ea0&quot;,&quot;title&quot;:&quot; product-type system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product-type system  \&quot;before all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:474,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84e95e96-802c-452c-aed8-e13b1cfbc264&quot;,&quot;parentUUID&quot;:&quot;91393306-e88e-4460-a1b1-334c73233ea0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product-type system  \&quot;after all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21962897-109a-4fc0-adda-fdab511b98e0&quot;,&quot;parentUUID&quot;:&quot;91393306-e88e-4460-a1b1-334c73233ea0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;08935c4f-0340-4cdd-b6b7-723e9113c465&quot;,&quot;title&quot;:&quot; POST \&quot;/product-type/\&quot; Create new product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add new product type to database &quot;,&quot;fullTitle&quot;:&quot; product-type system   POST \&quot;/product-type/\&quot; Create new product type   Should add new product type to database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newProductType = {\n\tname: &#x27;Book&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/product-type/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newProductType)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tproductTypeId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a81372df-badf-48b1-bd4b-816bcf5b2456&quot;,&quot;parentUUID&quot;:&quot;08935c4f-0340-4cdd-b6b7-723e9113c465&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a81372df-badf-48b1-bd4b-816bcf5b2456&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d9d1cc27-52bc-4784-aceb-4b2c6142aa4e&quot;,&quot;title&quot;:&quot; GET \&quot;/product-type/\&quot; Get all product types &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all product types &quot;,&quot;fullTitle&quot;:&quot; product-type system   GET \&quot;/product-type/\&quot; Get all product types   Should return all product types &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/product-type/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29611973-a5d7-41ec-b0d0-fee9b0cf84ca&quot;,&quot;parentUUID&quot;:&quot;d9d1cc27-52bc-4784-aceb-4b2c6142aa4e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;29611973-a5d7-41ec-b0d0-fee9b0cf84ca&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8d26fb91-9b97-417f-aa95-8bc50ff51a61&quot;,&quot;title&quot;:&quot; GET \&quot;/product-type/:id\&quot; Get one product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one product type by id &quot;,&quot;fullTitle&quot;:&quot; product-type system   GET \&quot;/product-type/:id\&quot; Get one product type   Should return one product type by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/product-type/${productTypeId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f04d6372-3dfa-45f4-8c18-0c432f6537d6&quot;,&quot;parentUUID&quot;:&quot;8d26fb91-9b97-417f-aa95-8bc50ff51a61&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f04d6372-3dfa-45f4-8c18-0c432f6537d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7419a77a-1f1a-409f-89bf-d7269eeabeda&quot;,&quot;title&quot;:&quot; PATCH \&quot;/product-type/:id\&quot; Update one existing product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return product type with updated data &quot;,&quot;fullTitle&quot;:&quot; product-type system   PATCH \&quot;/product-type/:id\&quot; Update one existing product type   Should return product type with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedProductTypeData = {\n\tname: &#x27;E-Book&#x27;,\n\tkey: &#x27;e-book&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.patch(`/product-type/${productTypeId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedProductTypeData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2d1a716d-12c7-4ff9-8ae8-19f5dd15951e&quot;,&quot;parentUUID&quot;:&quot;7419a77a-1f1a-409f-89bf-d7269eeabeda&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2d1a716d-12c7-4ff9-8ae8-19f5dd15951e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fe6c0b6a-a2a4-4950-b807-3e0b58bf959e&quot;,&quot;title&quot;:&quot; DELETE \&quot;/prodcut-type/:id\&quot; Delete one product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should delete one product type from database &quot;,&quot;fullTitle&quot;:&quot; product-type system   DELETE \&quot;/prodcut-type/:id\&quot; Delete one product type   Should delete one product type from database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/product-type/${productTypeId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst productTypeObject = await mongoose.connection\n\t\t\t.collection(&#x27;producttypes&#x27;)\n\t\t\t.findOne();\n\t\texpect(productTypeObject).to.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0cd013d1-b0d5-40fb-b265-d7f959358ccd&quot;,&quot;parentUUID&quot;:&quot;fe6c0b6a-a2a4-4950-b807-3e0b58bf959e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0cd013d1-b0d5-40fb-b265-d7f959358ccd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0ff06a02-0468-4829-9e35-47b824d4a78f&quot;,&quot;title&quot;:&quot; publisher system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;fullTitle&quot;:&quot; publisher system  \&quot;before all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:491,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6176ce38-372e-4c86-b757-f84bc134c80e&quot;,&quot;parentUUID&quot;:&quot;0ff06a02-0468-4829-9e35-47b824d4a78f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;fullTitle&quot;:&quot; publisher system  \&quot;after all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f7e6c93-1465-4164-b0cb-933b7b461ccd&quot;,&quot;parentUUID&quot;:&quot;0ff06a02-0468-4829-9e35-47b824d4a78f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ce504d9a-086c-43de-8a98-3c5818e4d119&quot;,&quot;title&quot;:&quot; POST \&quot;/publisher/\&quot; Create new publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new publisher &quot;,&quot;fullTitle&quot;:&quot; publisher system   POST \&quot;/publisher/\&quot; Create new publisher   Should create new publisher &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newPublisher = {\n\tname: &#x27;OpenAI&#x27;,\n\tbooks: [],\n\tbookSeries: [],\n\tdescription: &#x27;Publishing company specializing in AI research&#x27;,\n\tlogo: &#x27;https://example.com/logo.png&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;bookSeries&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/publisher/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newPublisher)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tpublisherId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a5f9cb3-0c28-421a-97f9-c4004c7bebea&quot;,&quot;parentUUID&quot;:&quot;ce504d9a-086c-43de-8a98-3c5818e4d119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4a5f9cb3-0c28-421a-97f9-c4004c7bebea&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9948ae26-29d5-4b6e-bdf9-6b453520a568&quot;,&quot;title&quot;:&quot; GET \&quot;/publisher/\&quot; Get all publishers &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return fll publishers &quot;,&quot;fullTitle&quot;:&quot; publisher system   GET \&quot;/publisher/\&quot; Get all publishers   Should return fll publishers &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/publisher/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;994036a7-1591-4ea1-bde2-b8e98b5b3e0b&quot;,&quot;parentUUID&quot;:&quot;9948ae26-29d5-4b6e-bdf9-6b453520a568&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;994036a7-1591-4ea1-bde2-b8e98b5b3e0b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6f72a4ed-5cac-4de7-8aa4-794f4938a511&quot;,&quot;title&quot;:&quot; GET \&quot;/publisher/:id\&quot; Get one publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one publisher by id &quot;,&quot;fullTitle&quot;:&quot; publisher system   GET \&quot;/publisher/:id\&quot; Get one publisher   Should return one publisher by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;bookSeries&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/publisher/${publisherId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7b6d665-e0ce-4c16-853f-0867a5ec22d3&quot;,&quot;parentUUID&quot;:&quot;6f72a4ed-5cac-4de7-8aa4-794f4938a511&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c7b6d665-e0ce-4c16-853f-0867a5ec22d3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6885b8fa-7939-4730-9b1e-e1cc5e306eef&quot;,&quot;title&quot;:&quot; PATCH \&quot;/publisher/:id\&quot; Update one existing publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one publisher with updated data &quot;,&quot;fullTitle&quot;:&quot; publisher system   PATCH \&quot;/publisher/:id\&quot; Update one existing publisher   Should return one publisher with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedPublisherData = {\n\tname: &#x27;Updated Publisher&#x27;,\n\tdescription:\n\t\t&#x27;This is an updated description with more than 40 characters.&#x27;,\n\tlogo: &#x27;https://example.com/updated-logo.png&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;bookSeries&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.patch(`/publisher/${publisherId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedPublisherData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9de71e57-cda8-4bbe-aa73-66470aec598c&quot;,&quot;parentUUID&quot;:&quot;6885b8fa-7939-4730-9b1e-e1cc5e306eef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9de71e57-cda8-4bbe-aa73-66470aec598c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;27d1b4cd-1660-4fe7-8aa2-23437935711b&quot;,&quot;title&quot;:&quot; DELETE \&quot;/publisher/:id\&quot; Delete one publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; publisher system   DELETE \&quot;/publisher/:id\&quot; Delete one publisher   Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/publisher/${publisherId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst publisher = await mongoose.connection\n\t\t\t.collection(&#x27;publishers&#x27;)\n\t\t\t.findOne({});\n\t\texpect(publisher.deletedAt).to.be.not.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d76e9bd5-63f2-4613-b5b2-c445ec7c445b&quot;,&quot;parentUUID&quot;:&quot;27d1b4cd-1660-4fe7-8aa2-23437935711b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d76e9bd5-63f2-4613-b5b2-c445ec7c445b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0fb22fd1-2727-49aa-9ff4-763e95a77b9f&quot;,&quot;title&quot;:&quot; review system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;fullTitle&quot;:&quot; review system  \&quot;before all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:463,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17580270-7bee-44ff-82a6-aa3807a62e34&quot;,&quot;parentUUID&quot;:&quot;0fb22fd1-2727-49aa-9ff4-763e95a77b9f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;fullTitle&quot;:&quot; review system  \&quot;after all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;reviews&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69879493-eaeb-4f65-95cb-b8e9f3c20932&quot;,&quot;parentUUID&quot;:&quot;0fb22fd1-2727-49aa-9ff4-763e95a77b9f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b484284a-4126-4258-8bec-36d57a904f97&quot;,&quot;title&quot;:&quot; POST \&quot;/review/\&quot; Create new review &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new review &quot;,&quot;fullTitle&quot;:&quot; review system   POST \&quot;/review/\&quot; Create new review   Should create new review &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tdeliveryPrice: 60,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tmodel: &#x27;Book&#x27;\n};\nconst productId = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product)\n).body._id;\nconst userId = (\n\tawait mongoose.connection.collection(&#x27;users&#x27;).findOne({})\n)._id;\n//#endregion\nconst review = {\n\tproduct: productId,\n\tuser: userId,\n\ttitle: &#x27;Приголомшлива книжкова подорож&#x27;,\n\ttext: &#x27;Ця книга змушує вас погрузнутися у захопливий світ, де кожна сторінка відкриває нові глибини емоцій та незабутніх пригод. Ви не зможете відірвати очі від її сторінок, а кожне речення залишить слід у вашому серці.&#x27;,\n\trating: 5\n};\nconst expectedFields = [\n\t&#x27;product&#x27;,\n\t&#x27;user&#x27;,\n\t&#x27;title&#x27;,\n\t&#x27;text&#x27;,\n\t&#x27;likes&#x27;,\n\t&#x27;dislikes&#x27;,\n\t&#x27;rating&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/review/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(review)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\treviewId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0889b037-f5a9-4454-85a9-19b88a08232f&quot;,&quot;parentUUID&quot;:&quot;b484284a-4126-4258-8bec-36d57a904f97&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0889b037-f5a9-4454-85a9-19b88a08232f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:24,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;283ddbd5-efc8-4d42-9b16-27f633562246&quot;,&quot;title&quot;:&quot; PATCH \&quot;/review/:id\&quot; Update one existing review &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one section with updated data &quot;,&quot;fullTitle&quot;:&quot; review system   PATCH \&quot;/review/:id\&quot; Update one existing review   Should return one section with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedReviewData = {\n\ttitle: &#x27;Приголомшлива подорож.&#x27;\n};\nawait request(app)\n\t.patch(`/review/${reviewId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedReviewData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.title).to.be.equal(\n\t\t\t&#x27;Приголомшлива подорож.&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b2a4d978-5a12-41f4-99ea-b5e1a5b345b3&quot;,&quot;parentUUID&quot;:&quot;283ddbd5-efc8-4d42-9b16-27f633562246&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b2a4d978-5a12-41f4-99ea-b5e1a5b345b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d43c53bd-dc1e-429b-a2b2-36e5220f1783&quot;,&quot;title&quot;:&quot; DELETE \&quot;/review/:id\&quot; Delete one review &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark review as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; review system   DELETE \&quot;/review/:id\&quot; Delete one review   Should mark review as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/review/${reviewId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst review = await mongoose.connection\n\t\t\t.collection(&#x27;reviews&#x27;)\n\t\t\t.findOne({});\n\t\texpect(review.deletedAt).to.be.not.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd619a92-bb87-4d5a-b7da-910438c6dc59&quot;,&quot;parentUUID&quot;:&quot;d43c53bd-dc1e-429b-a2b2-36e5220f1783&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cd619a92-bb87-4d5a-b7da-910438c6dc59&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9a96e148-9e00-433f-b795-8149a40383c2&quot;,&quot;title&quot;:&quot; serach system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\search-test.js&quot;,&quot;file&quot;:&quot;\\test\\search-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;fullTitle&quot;:&quot; serach system  \&quot;before all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:474,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;65b0101a-c17d-43c6-b89e-5d88640f5e6a&quot;,&quot;parentUUID&quot;:&quot;9a96e148-9e00-433f-b795-8149a40383c2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;fullTitle&quot;:&quot; serach system  \&quot;after all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cdd78619-6148-43ae-b028-86537830a20f&quot;,&quot;parentUUID&quot;:&quot;9a96e148-9e00-433f-b795-8149a40383c2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;2288f7c0-e934-4f0d-a9c2-23bf3d7ef49a&quot;,&quot;title&quot;:&quot;GET \&quot;/search?q=\&quot; Search for product(s) &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\search-test.js&quot;,&quot;file&quot;:&quot;\\test\\search-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;GET \&quot;/search?q=\&quot; Search for product(s) \&quot;&quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)  \&quot;before all\&quot; hook in \&quot;GET \&quot;/search?q=\&quot; Search for product(s) \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:37,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst author = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbiography:\n\t\t&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nawait mongoose.connection\n\t.collection(&#x27;authors&#x27;)\n\t.insertOne(author);\nconst authorName = (\n\tawait mongoose.connection.collection(&#x27;authors&#x27;).findOne({})\n).fullName;\nconst product1 = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst product2 = {\n\tname: &#x27;Мистецтво говорити. Таємниці ефективного спілкування&#x27;,\n\ttype: productTypeId,\n\tprice: 80,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;Бізнес-тренер Джеймс Борґ, відомий своїми відкриттями в галузях спілкування, особистісного розвитку, мови тіла та «контролю мислення», пропонує прості і дієві поради для кожної людини. &#x27;,\n\timages: [&#x27;image2.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst product3 = {\n\tname: &#x27;48 законів влади&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;Сорок вісім хитрих, безжальних, повчальних законів влади від Роберта Гріна, які стануть у пригоді кожному, хто прагне досягати вершин.&#x27;,\n\timages: [&#x27;image3.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nproduct1Code = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product1)\n).body.code;\nawait request(app)\n\t.post(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(product2);\nawait request(app)\n\t.post(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(product3);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a931ae61-be15-46ec-8de6-8c3465d14289&quot;,&quot;parentUUID&quot;:&quot;2288f7c0-e934-4f0d-a9c2-23bf3d7ef49a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return three poducts with entered author &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return three poducts with entered author &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/search?q=${&#x27;John Smith&#x27;}`)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(3);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3be9853f-874e-4b3c-b137-70f9572e0edc&quot;,&quot;parentUUID&quot;:&quot;2288f7c0-e934-4f0d-a9c2-23bf3d7ef49a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot; Should return three products with an incomplete entered author &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return three products with an incomplete entered author &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/search?q=${&#x27;Joh&#x27;}`)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(3);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3620237c-d10b-4b97-8644-ef8a7ba2ddf2&quot;,&quot;parentUUID&quot;:&quot;2288f7c0-e934-4f0d-a9c2-23bf3d7ef49a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot; Should return one product with entered product code &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return one product with entered product code &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/search?q=${product1Code}`)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(1);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b7ea676-7912-4d9d-b2e1-93947f7906b5&quot;,&quot;parentUUID&quot;:&quot;2288f7c0-e934-4f0d-a9c2-23bf3d7ef49a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot; Should return one product with an incomplete entered product name &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return one product with an incomplete entered product name &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(\n\t\t`/search?q=${encodeURIComponent(\n\t\t\t&#x27;Мистецтво говорити. Таємниці ефективного спілкування&#x27;\n\t\t)}`\n\t)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(1);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;93afc0b5-9f38-4a7a-a555-9442cbebe0a3&quot;,&quot;parentUUID&quot;:&quot;2288f7c0-e934-4f0d-a9c2-23bf3d7ef49a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3be9853f-874e-4b3c-b137-70f9572e0edc&quot;,&quot;3620237c-d10b-4b97-8644-ef8a7ba2ddf2&quot;,&quot;3b7ea676-7912-4d9d-b2e1-93947f7906b5&quot;,&quot;93afc0b5-9f38-4a7a-a555-9442cbebe0a3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:21,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5226e7b8-63af-41a4-ba7d-cab530e6eebc&quot;,&quot;title&quot;:&quot; section system&quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;fullTitle&quot;:&quot; section system \&quot;before all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:470,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;577f7cb5-dce0-43ab-a3ad-237b87814efa&quot;,&quot;parentUUID&quot;:&quot;5226e7b8-63af-41a4-ba7d-cab530e6eebc&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;fullTitle&quot;:&quot; section system \&quot;after all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1cbf7b8a-89bd-48a5-8867-f78a0998fff0&quot;,&quot;parentUUID&quot;:&quot;5226e7b8-63af-41a4-ba7d-cab530e6eebc&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ce8e48a0-0df2-49f5-9e67-f3b87ee0aa15&quot;,&quot;title&quot;:&quot; POST \&quot;/section/\&quot; Create new section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add new section to database &quot;,&quot;fullTitle&quot;:&quot; section system  POST \&quot;/section/\&quot; Create new section   Should add new section to database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const section = {\n\tname: &#x27;Художня література&#x27;,\n\tkey: &#x27;khudozhnia-literatura&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;key&#x27;,\n\t&#x27;products&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;sections&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/section/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(section)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tsectionId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1e7c3f3-6762-41c2-9057-e531e9063927&quot;,&quot;parentUUID&quot;:&quot;ce8e48a0-0df2-49f5-9e67-f3b87ee0aa15&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c1e7c3f3-6762-41c2-9057-e531e9063927&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;35dc4876-458f-4150-9ada-fce0eeac60a2&quot;,&quot;title&quot;:&quot; GET \&quot;/section/\&quot; Get all sections &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all sections  &quot;,&quot;fullTitle&quot;:&quot; section system  GET \&quot;/section/\&quot; Get all sections   Should return all sections  &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/section/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;71f38852-2eeb-427a-b137-22838bd04e0c&quot;,&quot;parentUUID&quot;:&quot;35dc4876-458f-4150-9ada-fce0eeac60a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;71f38852-2eeb-427a-b137-22838bd04e0c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8e47ae94-dfef-43f2-b22f-d6dfd405468e&quot;,&quot;title&quot;:&quot; GET \&quot;/section/:id\&quot; Get one section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one section by id &quot;,&quot;fullTitle&quot;:&quot; section system  GET \&quot;/section/:id\&quot; Get one section   Should return one section by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [&#x27;name&#x27;, &#x27;key&#x27;, &#x27;_id&#x27;, &#x27;sections&#x27;];\nawait request(app)\n\t.get(`/section/${sectionId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d871f6a-2f05-4787-80f6-e5a9ca274b2b&quot;,&quot;parentUUID&quot;:&quot;8e47ae94-dfef-43f2-b22f-d6dfd405468e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5d871f6a-2f05-4787-80f6-e5a9ca274b2b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e6d99d1b-7fdf-4643-aaaa-2164bcc6474f&quot;,&quot;title&quot;:&quot; PATCH \&quot;/section/:id\&quot; Update one existing section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return updated section &quot;,&quot;fullTitle&quot;:&quot; section system  PATCH \&quot;/section/:id\&quot; Update one existing section   Should return updated section &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst newSection = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst newSectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(newSection)\n).insertedId;\n//#endregion\nconst updatedSectionData = {\n\tsections: [newSectionId]\n};\nawait request(app)\n\t.patch(`/section/${sectionId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedSectionData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.sections).to.include(\n\t\t\tnewSectionId.toString()\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25ba2038-a097-49f0-901c-6b3a2c914d2d&quot;,&quot;parentUUID&quot;:&quot;e6d99d1b-7fdf-4643-aaaa-2164bcc6474f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;25ba2038-a097-49f0-901c-6b3a2c914d2d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;66674deb-ede5-4476-a274-7e6acec3bf52&quot;,&quot;title&quot;:&quot; GET \&quot;/section/:id/products\&quot; Get all section products &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all section products &quot;,&quot;fullTitle&quot;:&quot; section system  GET \&quot;/section/:id/products\&quot; Get all section products   Should return all section products &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/section/${sectionId}/products`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.result).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f416bb55-2e97-4f1e-a007-43938c16aa83&quot;,&quot;parentUUID&quot;:&quot;66674deb-ede5-4476-a274-7e6acec3bf52&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f416bb55-2e97-4f1e-a007-43938c16aa83&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;71765386-a414-474b-8771-990206174429&quot;,&quot;title&quot;:&quot; DELETE \&quot;/section/:id\&quot; Delete one section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; section system  DELETE \&quot;/section/:id\&quot; Delete one section   Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/section/${sectionId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst section = await mongoose.connection\n\t\t\t.collection(&#x27;sections&#x27;)\n\t\t\t.findOne({ _id: new ObjectId(sectionId) });\n\t\texpect(section.deletedAt).not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b09027c-c376-46cc-98b2-b9b86144dd41&quot;,&quot;parentUUID&quot;:&quot;71765386-a414-474b-8771-990206174429&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5b09027c-c376-46cc-98b2-b9b86144dd41&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f0c3c20b-6925-4216-ae55-645d23c5e77d&quot;,&quot;title&quot;:&quot; translator system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; translator system  \&quot;before all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:504,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12883cdb-b1bf-437f-8d8f-ea8ca2da40a3&quot;,&quot;parentUUID&quot;:&quot;f0c3c20b-6925-4216-ae55-645d23c5e77d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; translator system  \&quot;after all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;translators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6129671-727a-4fcf-bb91-81bef7829987&quot;,&quot;parentUUID&quot;:&quot;f0c3c20b-6925-4216-ae55-645d23c5e77d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;387c336a-84f2-4297-919e-9ec747d95f2b&quot;,&quot;title&quot;:&quot; POST \&quot;/translator/\&quot; Create new translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new translator in database &quot;,&quot;fullTitle&quot;:&quot; translator system   POST \&quot;/translator/\&quot; Create new translator   Should create new translator in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newTranslator = {\n\tfullName: &#x27;Anna Petrova&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/translator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newTranslator)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\ttranslatorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1b7775b-b25a-4a99-a634-098b4c857cc0&quot;,&quot;parentUUID&quot;:&quot;387c336a-84f2-4297-919e-9ec747d95f2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b1b7775b-b25a-4a99-a634-098b4c857cc0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d83d88df-7551-4bdf-a5b8-6380e9227640&quot;,&quot;title&quot;:&quot; GET \&quot;/translator/\&quot; Get all translators &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all translators &quot;,&quot;fullTitle&quot;:&quot; translator system   GET \&quot;/translator/\&quot; Get all translators   Should return all translators &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/translator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb223435-0652-49aa-a192-183fd2044f56&quot;,&quot;parentUUID&quot;:&quot;d83d88df-7551-4bdf-a5b8-6380e9227640&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fb223435-0652-49aa-a192-183fd2044f56&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0aee8687-9b5c-4e91-849e-aa3bfde4d415&quot;,&quot;title&quot;:&quot; GET \&quot;/translator/:id\&quot; Get one translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one translator by id &quot;,&quot;fullTitle&quot;:&quot; translator system   GET \&quot;/translator/:id\&quot; Get one translator   Should return one translator by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/translator/${translatorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42b6a537-4d67-4c24-a935-74b3ec2ad09b&quot;,&quot;parentUUID&quot;:&quot;0aee8687-9b5c-4e91-849e-aa3bfde4d415&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;42b6a537-4d67-4c24-a935-74b3ec2ad09b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;abdb6d33-326d-40e0-8931-516f4678a8df&quot;,&quot;title&quot;:&quot; PATCH \&quot;/translator/:id\&quot; Update one existing translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one translator with updated data &quot;,&quot;fullTitle&quot;:&quot; translator system   PATCH \&quot;/translator/:id\&quot; Update one existing translator   Should return one translator with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedTranslatorData = {\n\tfullName: &#x27;Updated translator name&#x27;\n};\nawait request(app)\n\t.patch(`/translator/${translatorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedTranslatorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated translator name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2020c403-1833-4a4c-9028-9ab7b5fabcca&quot;,&quot;parentUUID&quot;:&quot;abdb6d33-326d-40e0-8931-516f4678a8df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2020c403-1833-4a4c-9028-9ab7b5fabcca&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a46d794f-a3a4-4670-9d2b-6c0fe9f200a9&quot;,&quot;title&quot;:&quot; DELETE \&quot;/translator/:id\&quot; Delete one translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark translator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; translator system   DELETE \&quot;/translator/:id\&quot; Delete one translator   Should mark translator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/translator/${translatorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedTranslator = await mongoose.connection\n\t\t\t.collection(&#x27;translators&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedTranslator.deletedAt).to.be.not.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e9e3bba-87e3-404d-a5c6-4e645a4202b6&quot;,&quot;parentUUID&quot;:&quot;a46d794f-a3a4-4670-9d2b-6c0fe9f200a9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5e9e3bba-87e3-404d-a5c6-4e645a4202b6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a56aee03-8e6d-4e18-83f7-b2e40aee498a&quot;,&quot;title&quot;:&quot;user system&quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;fullTitle&quot;:&quot;user system \&quot;before all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:493,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec4c6155-a208-4ab2-870c-2d9e1803aa05&quot;,&quot;parentUUID&quot;:&quot;a56aee03-8e6d-4e18-83f7-b2e40aee498a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;fullTitle&quot;:&quot;user system \&quot;after all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40586325-83c2-40ca-94ce-a343103760bf&quot;,&quot;parentUUID&quot;:&quot;a56aee03-8e6d-4e18-83f7-b2e40aee498a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;69a9f355-cff3-4580-87e2-315593b69cd9&quot;,&quot;title&quot;:&quot; GET \&quot;/user/\&quot; Get all users &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return an array of users &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/\&quot; Get all users   Should return an array of users &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/user/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t\tuserId = response.body[0]._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c3d6106-d857-408f-aed3-df476d4f9148&quot;,&quot;parentUUID&quot;:&quot;69a9f355-cff3-4580-87e2-315593b69cd9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1c3d6106-d857-408f-aed3-df476d4f9148&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fec9d8e7-678e-4915-ba8a-be5982ccacba&quot;,&quot;title&quot;:&quot; GET \&quot;/user/:id\&quot; Get one user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return user by id &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/:id\&quot; Get one user   Should return user by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;_id&#x27;,\n\t&#x27;firstName&#x27;,\n\t&#x27;lastName&#x27;,\n\t&#x27;phoneNumber&#x27;,\n\t&#x27;email&#x27;,\n\t&#x27;role&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;wishlist&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;cart&#x27;\n];\nawait request(app)\n\t.get(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b2e7bb16-caf0-4b8b-bb66-0ba772e4942a&quot;,&quot;parentUUID&quot;:&quot;fec9d8e7-678e-4915-ba8a-be5982ccacba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b2e7bb16-caf0-4b8b-bb66-0ba772e4942a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;12bc8a47-20ed-4fd3-98a0-1f9fdb9aa736&quot;,&quot;title&quot;:&quot; PATCH \&quot;/user/:id\&quot; Update one existing user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return the user with updated data &quot;,&quot;fullTitle&quot;:&quot;user system  PATCH \&quot;/user/:id\&quot; Update one existing user   Should return the user with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newData = {\n\tfirstName: &#x27;Артем&#x27;,\n\tlastName: &#x27;Желіковський&#x27;\n};\nawait request(app)\n\t.patch(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.firstName).to.equal(newData.firstName);\n\t\texpect(response.body.lastName).to.equal(newData.lastName);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17c537cd-59d7-423a-8954-821c3d9eea0f&quot;,&quot;parentUUID&quot;:&quot;12bc8a47-20ed-4fd3-98a0-1f9fdb9aa736&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;17c537cd-59d7-423a-8954-821c3d9eea0f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;23d18837-e408-4770-b493-a6c33f706bc7&quot;,&quot;title&quot;:&quot; DELETE \&quot;/user/:id\&quot; Delete one user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark the user as deleted via the \&quot;deletedAt\&quot; field, but not delete him &quot;,&quot;fullTitle&quot;:&quot;user system  DELETE \&quot;/user/:id\&quot; Delete one user   Should mark the user as deleted via the \&quot;deletedAt\&quot; field, but not delete him &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newUser = {\n\tfirstName: &#x27;Oleg&#x27;,\n\tlastName: &#x27;Smirniv&#x27;,\n\tphoneNumber: &#x27;380957846372&#x27;,\n\temail: &#x27;lahefi3700@devswp.com&#x27;,\n\tpassword: &#x27;41424344&#x27;,\n\trole: &#x27;user&#x27;\n};\nconst userId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;users&#x27;)\n\t\t.insertOne(newUser)\n).insertedId.toString();\nawait request(app)\n\t.delete(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async () =&gt; {\n\t\tconst deletedUser = await mongoose.connection\n\t\t\t.collection(&#x27;users&#x27;)\n\t\t\t.findOne({ email: &#x27;lahefi3700@devswp.com&#x27; });\n\t\texpect(deletedUser).to.include.keys(&#x27;deletedAt&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6597da18-11d0-475e-8303-81e2d480c232&quot;,&quot;parentUUID&quot;:&quot;23d18837-e408-4770-b493-a6c33f706bc7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6597da18-11d0-475e-8303-81e2d480c232&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8bdd6fcd-dd6d-4e26-83d5-f1918e12afdf&quot;,&quot;title&quot;:&quot; GET \&quot;/user/account\&quot; Get user account &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return information about the authorized user &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/account\&quot; Get user account   Should return information about the authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;_id&#x27;,\n\t&#x27;firstName&#x27;,\n\t&#x27;lastName&#x27;,\n\t&#x27;phoneNumber&#x27;,\n\t&#x27;email&#x27;,\n\t&#x27;role&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;wishlist&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;cart&#x27;\n];\nawait request(app)\n\t.get(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9129103-fe9a-48f8-b89d-b15d3be17da8&quot;,&quot;parentUUID&quot;:&quot;8bdd6fcd-dd6d-4e26-83d5-f1918e12afdf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c9129103-fe9a-48f8-b89d-b15d3be17da8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;464117f0-7dc6-452b-878f-c813ffe6f879&quot;,&quot;title&quot;:&quot; POST \&quot;/user/wishlist/\&quot; Add product to user&#x27;s wishlist &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add product to wishlist &quot;,&quot;fullTitle&quot;:&quot;user system  POST \&quot;/user/wishlist/\&quot; Add product to user&#x27;s wishlist   Should add product to wishlist &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99.99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tmodel: &#x27;Book&#x27;\n};\nproductId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;products&#x27;)\n\t\t.insertOne(product)\n).insertedId;\n//#endregion\nconst requestBody = {\n\tproduct: productId\n};\nawait request(app)\n\t.post(&#x27;/user/wishlist&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(requestBody)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst userWishlist = (\n\t\t\tawait mongoose.connection.collection(&#x27;users&#x27;).findOne()\n\t\t).wishlist;\n\t\texpect(\n\t\t\tuserWishlist.map(obj =&gt; obj.toString())\n\t\t).to.be.include(productId.toString());\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29724bea-2236-43b4-bb19-957a818b8a56&quot;,&quot;parentUUID&quot;:&quot;464117f0-7dc6-452b-878f-c813ffe6f879&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;29724bea-2236-43b4-bb19-957a818b8a56&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;96921d7d-00ba-48a7-9ce5-80d739dc9e0a&quot;,&quot;title&quot;:&quot; DELETE \&quot;/user/wishlist/\&quot; Remove product from user&#x27;s wishlist &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Must remove product from wishlist &quot;,&quot;fullTitle&quot;:&quot;user system  DELETE \&quot;/user/wishlist/\&quot; Remove product from user&#x27;s wishlist   Must remove product from wishlist &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const requestBody = {\n\tproduct: productId\n};\nawait request(app)\n\t.delete(&#x27;/user/wishlist/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(requestBody)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst userWishlist = (\n\t\t\tawait mongoose.connection.collection(&#x27;users&#x27;).findOne()\n\t\t).wishlist;\n\t\texpect(userWishlist).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c391852b-a6f1-4aa6-b336-fd3f0ef05450&quot;,&quot;parentUUID&quot;:&quot;96921d7d-00ba-48a7-9ce5-80d739dc9e0a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c391852b-a6f1-4aa6-b336-fd3f0ef05450&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ba6f4134-71e5-409b-973a-6e8d1b7c4548&quot;,&quot;title&quot;:&quot; GET \&quot;/user/orders/\&quot; Get all orders made by user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return an array of orders &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/orders/\&quot; Get all orders made by user   Should return an array of orders &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/user/orders/`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26b064e2-a7db-4987-b5f1-86346eaa1c25&quot;,&quot;parentUUID&quot;:&quot;ba6f4134-71e5-409b-973a-6e8d1b7c4548&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;26b064e2-a7db-4987-b5f1-86346eaa1c25&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.2.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;api&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\mochawesome-report\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\mochawesome-report\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>