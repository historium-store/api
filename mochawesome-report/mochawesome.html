<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:107,&quot;tests&quot;:90,&quot;passes&quot;:90,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2023-07-16T10:33:26.106Z&quot;,&quot;end&quot;:&quot;2023-07-16T10:33:43.677Z&quot;,&quot;duration&quot;:17571,&quot;testsRegistered&quot;:90,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;ae8143e0-b672-4e63-92aa-c6a42c615faf&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6c1bfe88-3fc5-41a5-ae1a-4aa8178571e5&quot;,&quot;title&quot;:&quot;auth system&quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\auth-test.js&quot;,&quot;file&quot;:&quot;\\test\\auth-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;fullTitle&quot;:&quot;auth system \&quot;before all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac1d353d-65c3-4a98-b1cf-b7ae3bad3201&quot;,&quot;parentUUID&quot;:&quot;6c1bfe88-3fc5-41a5-ae1a-4aa8178571e5&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;fullTitle&quot;:&quot;auth system \&quot;after all\&quot; hook in \&quot;auth system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7454c9ef-48a0-4a58-8b3d-9c5b165ec5e4&quot;,&quot;parentUUID&quot;:&quot;6c1bfe88-3fc5-41a5-ae1a-4aa8178571e5&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;33be64df-2d0c-4c33-8886-ebe93fb78365&quot;,&quot;title&quot;:&quot; \&quot;/signup\&quot; Create new user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\auth-test.js&quot;,&quot;file&quot;:&quot;\\test\\auth-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;The data should be validated and the body of the created user should be returned&quot;,&quot;fullTitle&quot;:&quot;auth system  \&quot;/signup\&quot; Create new user  The data should be validated and the body of the created user should be returned&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:320,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;firstName&#x27;,\n\t&#x27;lastName&#x27;,\n\t&#x27;phoneNumber&#x27;,\n\t&#x27;email&#x27;,\n\t&#x27;role&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;history&#x27;,\n\t&#x27;wishlist&#x27;,\n\t&#x27;waitlist&#x27;\n];\nawait request(app)\n\t.post(&#x27;/signup&#x27;)\n\t.send(adminUser)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf6a5ddf-8fa7-4e98-b25c-6d724478ea3a&quot;,&quot;parentUUID&quot;:&quot;33be64df-2d0c-4c33-8886-ebe93fb78365&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cf6a5ddf-8fa7-4e98-b25c-6d724478ea3a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:320,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6980da33-a0e3-4219-9228-d486449f5d37&quot;,&quot;title&quot;:&quot; \&quot;/login\&quot; Login existing user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\auth-test.js&quot;,&quot;file&quot;:&quot;\\test\\auth-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;The password and login are correct, the token is returned&quot;,&quot;fullTitle&quot;:&quot;auth system  \&quot;/login\&quot; Login existing user  The password and login are correct, the token is returned&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:251,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const inputData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nawait request(app)\n\t.post(&#x27;/login&#x27;)\n\t.send(inputData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(&#x27;token&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3bb0d681-3930-4640-b6c7-a49aa67191b0&quot;,&quot;parentUUID&quot;:&quot;6980da33-a0e3-4219-9228-d486449f5d37&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3bb0d681-3930-4640-b6c7-a49aa67191b0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:251,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;62cf29b9-2024-49d0-acee-23ad71d8e210&quot;,&quot;title&quot;:&quot; author system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;fullTitle&quot;:&quot; author system  \&quot;before all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:529,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;703a4691-210c-4186-9f08-e4df311ab473&quot;,&quot;parentUUID&quot;:&quot;62cf29b9-2024-49d0-acee-23ad71d8e210&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;fullTitle&quot;:&quot; author system  \&quot;after all\&quot; hook in \&quot; author system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9c7c5e1-21c8-405e-ab2e-fbf78f316407&quot;,&quot;parentUUID&quot;:&quot;62cf29b9-2024-49d0-acee-23ad71d8e210&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;bb2af094-e1ac-49f6-af28-73ef6fcb896a&quot;,&quot;title&quot;:&quot; POST \&quot;/author/\&quot; Create new author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Shoud create new author in database &quot;,&quot;fullTitle&quot;:&quot; author system   POST \&quot;/author/\&quot; Create new author   Shoud create new author in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newAuthor = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbiography:\n\t\t&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;biography&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;pictures&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/author/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newAuthor)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tauthorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4ff4bb4-ebcd-4f32-9c81-e3893a81f9cc&quot;,&quot;parentUUID&quot;:&quot;bb2af094-e1ac-49f6-af28-73ef6fcb896a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e4ff4bb4-ebcd-4f32-9c81-e3893a81f9cc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:14,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;36df982a-4870-4599-8e3c-488b01ff4672&quot;,&quot;title&quot;:&quot; GET \&quot;/author/\&quot; Get all authors &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all authors &quot;,&quot;fullTitle&quot;:&quot; author system   GET \&quot;/author/\&quot; Get all authors   Should return all authors &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/author/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a1fb4120-26d5-460a-b8a9-b27115f41630&quot;,&quot;parentUUID&quot;:&quot;36df982a-4870-4599-8e3c-488b01ff4672&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a1fb4120-26d5-460a-b8a9-b27115f41630&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4ee6a59e-33f5-4e47-82d2-f55e8e5f2acb&quot;,&quot;title&quot;:&quot; GET \&quot;/author/:id\&quot; Get one author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one author by id &quot;,&quot;fullTitle&quot;:&quot; author system   GET \&quot;/author/:id\&quot; Get one author   Should return one author by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;biography&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;pictures&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/author/${authorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a77603d0-25a4-4551-826d-8fb924062a30&quot;,&quot;parentUUID&quot;:&quot;4ee6a59e-33f5-4e47-82d2-f55e8e5f2acb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a77603d0-25a4-4551-826d-8fb924062a30&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;bcec0358-ea47-4799-b639-d0e00ebabf21&quot;,&quot;title&quot;:&quot; PATCH \&quot;/author/:id\&quot; Update one existing author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one author with updated data &quot;,&quot;fullTitle&quot;:&quot; author system   PATCH \&quot;/author/:id\&quot; Update one existing author   Should return one author with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedAuthorData = {\n\tfullName: \&quot;Ім&#x27;ян Прізвиськов\&quot;,\n\tpictures: [&#x27;url-to-new-picture&#x27;, &#x27;url-to-another-new-picture&#x27;]\n};\nawait request(app)\n\t.patch(`/author/${authorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedAuthorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.equal(\n\t\t\t\&quot;Ім&#x27;ян Прізвиськов\&quot;\n\t\t);\n\t\texpect(response.body.pictures).to.includes(\n\t\t\t&#x27;url-to-new-picture&#x27;,\n\t\t\t&#x27;url-to-another-new-picture&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff2748a1-5963-4d43-ab37-8cd391040f92&quot;,&quot;parentUUID&quot;:&quot;bcec0358-ea47-4799-b639-d0e00ebabf21&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ff2748a1-5963-4d43-ab37-8cd391040f92&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:17,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;df5219e6-e7ba-464f-a2d4-e6c88bbee5df&quot;,&quot;title&quot;:&quot; DELETE \&quot;/author/:id\&quot; Delete one author &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\author-test.js&quot;,&quot;file&quot;:&quot;\\test\\author-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark author as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;fullTitle&quot;:&quot; author system   DELETE \&quot;/author/:id\&quot; Delete one author   Should mark author as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/author/${authorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst author = await mongoose.connection\n\t\t\t.collection(&#x27;authors&#x27;)\n\t\t\t.findOne({});\n\t\texpect(author.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c3d5944-0c12-4171-a2cb-9255e077c403&quot;,&quot;parentUUID&quot;:&quot;df5219e6-e7ba-464f-a2d4-e6c88bbee5df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7c3d5944-0c12-4171-a2cb-9255e077c403&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:16,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;03ff69f2-a733-4fb9-8567-6115a91392e6&quot;,&quot;title&quot;:&quot; banner system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;before all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;256a8864-a72c-4b53-a3d3-1ba3cc0d5f5d&quot;,&quot;parentUUID&quot;:&quot;03ff69f2-a733-4fb9-8567-6115a91392e6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;before each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userData = {\n\tlogin: &#x27;dobriy.edu@gmail.com&#x27;,\n\tpassword: &#x27;41424344&#x27;\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3d304ed2-9dcb-4e48-8cbc-85229ded2113&quot;,&quot;parentUUID&quot;:&quot;03ff69f2-a733-4fb9-8567-6115a91392e6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;after all\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;banners&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f3a723d8-fee6-47a9-9063-1a04b841a0cf&quot;,&quot;parentUUID&quot;:&quot;03ff69f2-a733-4fb9-8567-6115a91392e6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;fullTitle&quot;:&quot; banner system  \&quot;after each\&quot; hook in \&quot; banner system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;userToken = &#x27;Bearer &#x27;;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;955b2364-709a-4e04-a5f1-d68b184fed50&quot;,&quot;parentUUID&quot;:&quot;03ff69f2-a733-4fb9-8567-6115a91392e6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c7172303-3bdf-46d7-b62b-5c88ad39b867&quot;,&quot;title&quot;:&quot; \&quot;/banner/\&quot; POST request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; the banner data is correct; the new banner object is returned &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/\&quot; POST request   the banner data is correct; the new banner object is returned &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;743b6df1-8664-4064-a624-21db9cea4a02&quot;,&quot;parentUUID&quot;:&quot;c7172303-3bdf-46d7-b62b-5c88ad39b867&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;743b6df1-8664-4064-a624-21db9cea4a02&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b27e6323-6a97-46a0-8e1c-7e7f355d41d3&quot;,&quot;title&quot;:&quot; \&quot;/banner/\&quot; GET request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; should return an array of banners &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/\&quot; GET request   should return an array of banners &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f69ae00-123a-4fa9-88cf-2226bb5b7805&quot;,&quot;parentUUID&quot;:&quot;b27e6323-6a97-46a0-8e1c-7e7f355d41d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5f69ae00-123a-4fa9-88cf-2226bb5b7805&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e7c87f7d-2396-4e04-864f-36212877b981&quot;,&quot;title&quot;:&quot; \&quot;/banner/:id\&quot; GET request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; should return banner object&quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/:id\&quot; GET request   should return banner object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;082ae827-0769-44bc-8f8c-eaa91ea45d94&quot;,&quot;parentUUID&quot;:&quot;e7c87f7d-2396-4e04-864f-36212877b981&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;082ae827-0769-44bc-8f8c-eaa91ea45d94&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;92495a4a-4c15-4e26-9234-46581e59d925&quot;,&quot;title&quot;:&quot; \&quot;/banner/:id\&quot; PATCH request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; correct values are sent; the changed banner object is returned &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/:id\&quot; PATCH request   correct values are sent; the changed banner object is returned &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;517d3284-926b-4a97-8eab-05c08269f00f&quot;,&quot;parentUUID&quot;:&quot;92495a4a-4c15-4e26-9234-46581e59d925&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;517d3284-926b-4a97-8eab-05c08269f00f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;897e5216-f109-41eb-8500-e68d5fc4c6d4&quot;,&quot;title&quot;:&quot; \&quot;/banner/:id\&quot; DELETE request &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\banner-test.js&quot;,&quot;file&quot;:&quot;\\test\\banner-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; should set the \&quot;deletedAt\&quot; field. the object must be removed from the database &quot;,&quot;fullTitle&quot;:&quot; banner system   \&quot;/banner/:id\&quot; DELETE request   should set the \&quot;deletedAt\&quot; field. the object must be removed from the database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0ced1be-ac6d-4031-b892-2438d2f8111d&quot;,&quot;parentUUID&quot;:&quot;897e5216-f109-41eb-8500-e68d5fc4c6d4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d0ced1be-ac6d-4031-b892-2438d2f8111d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f2257e2a-b094-4c1f-bc83-9150ba9b4857&quot;,&quot;title&quot;:&quot; book-series system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;fullTitle&quot;:&quot; book-series system  \&quot;before all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:507,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;16c7abc5-b5dc-458f-971c-a50a200a49a7&quot;,&quot;parentUUID&quot;:&quot;f2257e2a-b094-4c1f-bc83-9150ba9b4857&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;fullTitle&quot;:&quot; book-series system  \&quot;after all\&quot; hook in \&quot; book-series system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;bookseries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;790fa1db-3f7c-41bc-97ec-a803baa7d68b&quot;,&quot;parentUUID&quot;:&quot;f2257e2a-b094-4c1f-bc83-9150ba9b4857&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6795b203-e0c8-4923-8e6e-3fe400138232&quot;,&quot;title&quot;:&quot; POST \&quot;/book-series/\&quot; Create new book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new book series in database &quot;,&quot;fullTitle&quot;:&quot; book-series system   POST \&quot;/book-series/\&quot; Create new book series   Should create new book series in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst Publisher = {\n\tname: &#x27;Новий Вік&#x27;,\n\tbooks: [],\n\tbookSeries: [],\n\tdescription:\n\t\t&#x27;Видавництво, спеціалізуючеся на публікації літератури різних жанрів&#x27;,\n\tlogo: &#x27;https://example.com/logo.png&#x27;\n};\nconst publisherId = (\n\tawait request(app)\n\t\t.post(&#x27;/publisher/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(Publisher)\n).body._id;\n//#endregion\nconst newBookSeries = {\n\tname: &#x27;Українська класика&#x27;,\n\tpublisher: publisherId,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/book-series/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newBookSeries)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tbookSeriesId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aee9ebb2-dfdc-4502-80ca-204df82773b3&quot;,&quot;parentUUID&quot;:&quot;6795b203-e0c8-4923-8e6e-3fe400138232&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;aee9ebb2-dfdc-4502-80ca-204df82773b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:23,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a14f9d5e-889c-4e9e-8878-572ee1d18875&quot;,&quot;title&quot;:&quot; GET \&quot;/book-series/\&quot; Get all book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all book series &quot;,&quot;fullTitle&quot;:&quot; book-series system   GET \&quot;/book-series/\&quot; Get all book series   Should return all book series &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/book-series/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86748cc2-ced3-4c9b-8199-8232c72149d0&quot;,&quot;parentUUID&quot;:&quot;a14f9d5e-889c-4e9e-8878-572ee1d18875&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;86748cc2-ced3-4c9b-8199-8232c72149d0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;917a007c-9eb1-42e5-b5e3-63450699726f&quot;,&quot;title&quot;:&quot; GET \&quot;/book-series/:id\&quot; Get one book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one book series by id &quot;,&quot;fullTitle&quot;:&quot; book-series system   GET \&quot;/book-series/:id\&quot; Get one book series   Should return one book series by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/book-series/${bookSeriesId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a72f0c45-2204-4cc5-aebe-5a0edfed5831&quot;,&quot;parentUUID&quot;:&quot;917a007c-9eb1-42e5-b5e3-63450699726f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a72f0c45-2204-4cc5-aebe-5a0edfed5831&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b7c3a11d-7b31-4930-a71a-19dc1632e0f4&quot;,&quot;title&quot;:&quot; PATCH \&quot;/book-series/:id\&quot; Update one existing book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one book series with updated data &quot;,&quot;fullTitle&quot;:&quot; book-series system   PATCH \&quot;/book-series/:id\&quot; Update one existing book series   Should return one book series with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedBookSeries = {\n\tname: &#x27;Українська класика *updated&#x27;\n};\nawait request(app)\n\t.patch(`/book-series/${bookSeriesId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedBookSeries)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.name).to.equal(\n\t\t\t&#x27;Українська класика *updated&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bf197e31-921d-456b-8dda-d3cbf609072c&quot;,&quot;parentUUID&quot;:&quot;b7c3a11d-7b31-4930-a71a-19dc1632e0f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bf197e31-921d-456b-8dda-d3cbf609072c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:16,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;731a1912-db44-4cd7-a937-dff317603bba&quot;,&quot;title&quot;:&quot; DELETE \&quot;/book-series/:id\&quot; Delete one book series &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-series-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-series-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark book series as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; book-series system   DELETE \&quot;/book-series/:id\&quot; Delete one book series   Should mark book series as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/book-series/${bookSeriesId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedBookSeries = await mongoose.connection\n\t\t\t.collection(&#x27;bookseries&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedBookSeries.deletedAt).to.not.be.null;\n\t\tconst publisher = await mongoose.connection\n\t\t\t.collection(&#x27;publishers&#x27;)\n\t\t\t.findOne({});\n\t\texpect(publisher.bookSeries).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10f1a2e9-1cb7-4147-899f-2f111bdc9a4c&quot;,&quot;parentUUID&quot;:&quot;731a1912-db44-4cd7-a937-dff317603bba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;10f1a2e9-1cb7-4147-899f-2f111bdc9a4c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e9d1de85-d48d-44d0-a246-80b3b8b0278a&quot;,&quot;title&quot;:&quot; boook system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;fullTitle&quot;:&quot; boook system  \&quot;before all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:506,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8661470a-e4d4-49c8-8257-43364e166c11&quot;,&quot;parentUUID&quot;:&quot;e9d1de85-d48d-44d0-a246-80b3b8b0278a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;fullTitle&quot;:&quot; boook system  \&quot;after all\&quot; hook in \&quot; boook system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;books&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;bookseries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;compilers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;editors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;illustrators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;translators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2077be42-42ee-426a-a93d-de7db1610afd&quot;,&quot;parentUUID&quot;:&quot;e9d1de85-d48d-44d0-a246-80b3b8b0278a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;99201aff-ed45-4f2c-b081-8aa40e3ea2a4&quot;,&quot;title&quot;:&quot; POST \&quot;/book/\&quot; Create new book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new book to database &quot;,&quot;fullTitle&quot;:&quot; boook system   POST \&quot;/book/\&quot; Create new book   Should create new book to database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Комікси і графічні романи&#x27;,\n\tkey: &#x27;Komiksy i hrafichni romany&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst publisher = {\n\tname: &#x27;Новий Вік&#x27;,\n\tbooks: [],\n\tbookSeries: [],\n\tdescription:\n\t\t&#x27;Видавництво, спеціалізуючеся на публікації літератури різних жанрів&#x27;,\n\tlogo: &#x27;https://example.com/logo.png&#x27;\n};\nconst publisherId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;publishers&#x27;)\n\t\t.insertOne(publisher)\n).insertedId;\nconst author = {\n\tfullName: &#x27;Іван Сидоренко&#x27;,\n\tbiography: &#x27;Текст біографії автора на українській мові.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nconst authorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;authors&#x27;)\n\t\t.insertOne(author)\n).insertedId;\nconst authorName = (\n\tawait mongoose.connection.collection(&#x27;authors&#x27;).findOne({})\n).fullName;\nconst compiler = {\n\tfullName: &#x27;Іван Бойко&#x27;,\n\tbooks: []\n};\nconst compilerId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;compilers&#x27;)\n\t\t.insertOne(compiler)\n).insertedId;\nconst translator = {\n\tfullName: &#x27;Анна Мельник&#x27;,\n\tbooks: []\n};\nconst translatorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;translators&#x27;)\n\t\t.insertOne(translator)\n).insertedId;\nconst illustrator = {\n\tfullName: &#x27;Ірина Левченко&#x27;,\n\tbooks: []\n};\nconst illustratorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;illustrators&#x27;)\n\t\t.insertOne(illustrator)\n).insertedId;\nconst editor = {\n\tfullName: &#x27;Юлія Григоренко&#x27;,\n\tbooks: []\n};\nconst editorId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;editors&#x27;)\n\t\t.insertOne(editor)\n).insertedId;\nconst bookSeries = {\n\tname: &#x27;Українська класика&#x27;,\n\tpublisher: publisherId,\n\tbooks: []\n};\nconst bookSeriesId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;bookseries&#x27;)\n\t\t.insertOne(bookSeries)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst productId = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product)\n).body._id;\n//#endregion\nconst expectedFields = [\n\t&#x27;product&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;languages&#x27;,\n\t&#x27;publishedIn&#x27;,\n\t&#x27;authors&#x27;,\n\t&#x27;compilers&#x27;,\n\t&#x27;translators&#x27;,\n\t&#x27;illustrators&#x27;,\n\t&#x27;editors&#x27;,\n\t&#x27;series&#x27;,\n\t&#x27;copies&#x27;,\n\t&#x27;isbns&#x27;,\n\t&#x27;firstPublishedIn&#x27;,\n\t&#x27;originalName&#x27;,\n\t&#x27;font&#x27;,\n\t&#x27;format&#x27;,\n\t&#x27;pages&#x27;,\n\t&#x27;weight&#x27;,\n\t&#x27;bindingType&#x27;,\n\t&#x27;paperType&#x27;,\n\t&#x27;illustrationsType&#x27;,\n\t&#x27;literaturePeriod&#x27;,\n\t&#x27;literatureCountry&#x27;,\n\t&#x27;foreignLiterature&#x27;,\n\t&#x27;timePeriod&#x27;,\n\t&#x27;suitableAge&#x27;,\n\t&#x27;packaging&#x27;,\n\t&#x27;occasion&#x27;,\n\t&#x27;style&#x27;,\n\t&#x27;suitableFor&#x27;\n];\nconst newBook = {\n\tproduct: productId,\n\ttype: &#x27;Паперова&#x27;,\n\tpublisher: publisherId,\n\tlanguages: [&#x27;Українська&#x27;],\n\tpublishedIn: &#x27;1980&#x27;,\n\tauthors: [authorId],\n\tcompilers: [compilerId],\n\ttranslators: [translatorId],\n\tillustrators: [illustratorId],\n\teditors: [editorId],\n\tseries: [bookSeriesId],\n\tcopies: 100,\n\tisbns: [&#x27;978-3-16-148410-0&#x27;],\n\tfirstPublishedIn: &#x27;1981&#x27;,\n\toriginalName: &#x27;Збірка українських поезій&#x27;,\n\tfont: &#x27;Arial&#x27;,\n\tformat: &#x27;135х205 мм&#x27;,\n\tpages: 180,\n\tweight: 300,\n\tbindingType: &#x27;Пришивна палітурка&#x27;,\n\tpaperType: &#x27;Глянцевий&#x27;,\n\tillustrationsType: [&#x27;Повнокольоровий&#x27;],\n\tliteraturePeriod: [&#x27;Постмодернізм&#x27;],\n\tliteratureCountry: [&#x27;Україна&#x27;],\n\tforeignLiterature: false,\n\ttimePeriod: [&#x27;1980-1990&#x27;],\n\tsuitableAge: [&#x27;12+&#x27;],\n\tpackaging: &#x27;У коробці&#x27;,\n\toccasion: [&#x27;Без приводу&#x27;],\n\tstyle: [&#x27;Сучасна поезія&#x27;],\n\tsuitableFor: [&#x27;Дорослих&#x27;]\n};\nawait request(app)\n\t.post(&#x27;/book/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newBook)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tbookId = response.body._id;\n\t\t//#region check data integrity\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;publishers&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;authors&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;compilers&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;translators&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;illustrators&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;editors&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\tawait mongoose.connection\n\t\t\t.collection(&#x27;bookseries&#x27;)\n\t\t\t.findOne({})\n\t\t\t.then(result =&gt; {\n\t\t\t\texpect(\n\t\t\t\t\tresult.books.map(id =&gt; id.toString())\n\t\t\t\t).to.include(bookId);\n\t\t\t});\n\t\t//#endregion\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3cf37238-6e8b-4607-bd31-d3baf1ad3199&quot;,&quot;parentUUID&quot;:&quot;99201aff-ed45-4f2c-b081-8aa40e3ea2a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3cf37238-6e8b-4607-bd31-d3baf1ad3199&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:76,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a973850b-4584-4c86-a1bc-e69cbd714d5d&quot;,&quot;title&quot;:&quot; GET \&quot;/book/\&quot; Get all books &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all books &quot;,&quot;fullTitle&quot;:&quot; boook system   GET \&quot;/book/\&quot; Get all books   Should return all books &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/book/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.result).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd2aeaf5-87eb-4797-8ed7-7c904c24e229&quot;,&quot;parentUUID&quot;:&quot;a973850b-4584-4c86-a1bc-e69cbd714d5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fd2aeaf5-87eb-4797-8ed7-7c904c24e229&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0e601670-f0ba-4bc2-8642-3e3f9547ae78&quot;,&quot;title&quot;:&quot; GET \&quot;/book/:id\&quot; Get one book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one book by id &quot;,&quot;fullTitle&quot;:&quot; boook system   GET \&quot;/book/:id\&quot; Get one book   Should return one book by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;product&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;publisher&#x27;,\n\t&#x27;languages&#x27;,\n\t&#x27;publishedIn&#x27;,\n\t&#x27;authors&#x27;,\n\t&#x27;compilers&#x27;,\n\t&#x27;translators&#x27;,\n\t&#x27;illustrators&#x27;,\n\t&#x27;editors&#x27;,\n\t&#x27;series&#x27;,\n\t&#x27;copies&#x27;,\n\t&#x27;isbns&#x27;,\n\t&#x27;firstPublishedIn&#x27;,\n\t&#x27;originalName&#x27;,\n\t&#x27;font&#x27;,\n\t&#x27;format&#x27;,\n\t&#x27;pages&#x27;,\n\t&#x27;weight&#x27;,\n\t&#x27;bindingType&#x27;,\n\t&#x27;paperType&#x27;,\n\t&#x27;illustrationsType&#x27;,\n\t&#x27;literaturePeriod&#x27;,\n\t&#x27;literatureCountry&#x27;,\n\t&#x27;foreignLiterature&#x27;,\n\t&#x27;timePeriod&#x27;,\n\t&#x27;suitableAge&#x27;,\n\t&#x27;packaging&#x27;,\n\t&#x27;occasion&#x27;,\n\t&#x27;style&#x27;,\n\t&#x27;suitableFor&#x27;\n];\nawait request(app)\n\t.get(`/book/${bookId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32f40f5e-dff4-4139-843f-502643a34443&quot;,&quot;parentUUID&quot;:&quot;0e601670-f0ba-4bc2-8642-3e3f9547ae78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;32f40f5e-dff4-4139-843f-502643a34443&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8ffc34eb-ba29-4e3e-abce-aba83aa6e2c1&quot;,&quot;title&quot;:&quot; PATCH \&quot;/book/:id\&quot; Update one existing book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return book with updated data &quot;,&quot;fullTitle&quot;:&quot; boook system   PATCH \&quot;/book/:id\&quot; Update one existing book   Should return book with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedBookData = {\n\tpublishedIn: &#x27;1982&#x27;,\n\tlanguages: [&#x27;English&#x27;]\n};\nawait request(app)\n\t.patch(`/book/${bookId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedBookData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.publishedIn).to.equal(1982);\n\t\texpect(response.body.languages).to.include(&#x27;English&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8dd12f7-a854-4da0-8229-1fe5b04639fa&quot;,&quot;parentUUID&quot;:&quot;8ffc34eb-ba29-4e3e-abce-aba83aa6e2c1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f8dd12f7-a854-4da0-8229-1fe5b04639fa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:19,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ea474632-3aa3-461c-98f7-1afbb8899b81&quot;,&quot;title&quot;:&quot; DELETE \&quot;/book/:id\&quot; Delete one book &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\book-test.js&quot;,&quot;file&quot;:&quot;\\test\\book-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;fullTitle&quot;:&quot; boook system   DELETE \&quot;/book/:id\&quot; Delete one book   Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/book/${bookId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedBook = await mongoose.connection\n\t\t\t.collection(&#x27;books&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedBook.deletedAt).to.not.be.null;\n\t\t//#region checking all dependencies\n\t\tconst author = await mongoose.connection\n\t\t\t.collection(&#x27;authors&#x27;)\n\t\t\t.findOne();\n\t\texpect(author.books).to.be.empty;\n\t\tconst compiler = await mongoose.connection\n\t\t\t.collection(&#x27;compilers&#x27;)\n\t\t\t.findOne();\n\t\texpect(compiler.books).to.be.empty;\n\t\tconst editor = await mongoose.connection\n\t\t\t.collection(&#x27;editors&#x27;)\n\t\t\t.findOne();\n\t\texpect(editor.books).to.be.empty;\n\t\tconst illustrator = await mongoose.connection\n\t\t\t.collection(&#x27;illustrators&#x27;)\n\t\t\t.findOne();\n\t\texpect(illustrator.books).to.be.empty;\n\t\tconst translator = await mongoose.connection\n\t\t\t.collection(&#x27;translators&#x27;)\n\t\t\t.findOne();\n\t\texpect(translator.books).to.be.empty;\n\t\tconst product = await mongoose.connection\n\t\t\t.collection(&#x27;products&#x27;)\n\t\t\t.findOne();\n\t\texpect(product.deletedAt).to.not.be.null;\n\t\tconst section = await mongoose.connection\n\t\t\t.collection(&#x27;sections&#x27;)\n\t\t\t.findOne();\n\t\texpect(section.products).to.be.empty;\n\t\t//#endregion\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2d46e39-1a7e-4c67-94b8-e05ce46c6dc2&quot;,&quot;parentUUID&quot;:&quot;ea474632-3aa3-461c-98f7-1afbb8899b81&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e2d46e39-1a7e-4c67-94b8-e05ce46c6dc2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:27,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ab8bbee5-5872-4e57-8f51-621003e5e8b4&quot;,&quot;title&quot;:&quot; cart system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;fullTitle&quot;:&quot; cart system  \&quot;before all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:496,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe8fd2ed-592d-4992-8fcc-f2bafb04f9fd&quot;,&quot;parentUUID&quot;:&quot;ab8bbee5-5872-4e57-8f51-621003e5e8b4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;fullTitle&quot;:&quot; cart system  \&quot;after all\&quot; hook in \&quot; cart system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;cartitems&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1dbcdc6a-df96-4e30-9cab-a0c1ff07a0bf&quot;,&quot;parentUUID&quot;:&quot;ab8bbee5-5872-4e57-8f51-621003e5e8b4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;70ab15d8-f2cb-49c8-91b6-849f33396d08&quot;,&quot;title&quot;:&quot; GET \&quot;/cart/\&quot; Get cart associated with user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return information about the cart of the authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   GET \&quot;/cart/\&quot; Get cart associated with user   Should return information about the cart of the authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [&#x27;items&#x27;, &#x27;totalPrice&#x27;, &#x27;totalQuantity&#x27;];\nawait request(app)\n\t.get(&#x27;/cart/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9bfcb0a7-1f63-438c-811a-a7f35ba47820&quot;,&quot;parentUUID&quot;:&quot;70ab15d8-f2cb-49c8-91b6-849f33396d08&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9bfcb0a7-1f63-438c-811a-a7f35ba47820&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;852b69e6-49ae-4b71-b0c4-985a86c68e04&quot;,&quot;title&quot;:&quot; DELETE \&quot;/cart/\&quot; Clear user cart &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should empty cart of the authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   DELETE \&quot;/cart/\&quot; Clear user cart   Should empty cart of the authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(&#x27;/cart/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cart.items).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cb87cc80-81d1-4697-85aa-82e4df41359e&quot;,&quot;parentUUID&quot;:&quot;852b69e6-49ae-4b71-b0c4-985a86c68e04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cb87cc80-81d1-4697-85aa-82e4df41359e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b766d581-8283-4519-926a-f9c787a09345&quot;,&quot;title&quot;:&quot; POST \&quot;/cart-item/\&quot; Add item to user cart &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add the product to the cart of an authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   POST \&quot;/cart-item/\&quot; Add item to user cart   Should add the product to the cart of an authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tdeliveryPrice: 60,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tmodel: &#x27;Book&#x27;\n};\nproductId = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product)\n).body._id;\n//#endregion\nconst body = {\n\tproduct: productId.toString()\n};\nawait request(app)\n\t.post(&#x27;/cart-item/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(body)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cart.items).to.be.not.empty;\n\t\tconst cartItem = await mongoose.connection\n\t\t\t.collection(&#x27;cartitems&#x27;)\n\t\t\t.findOne({ _id: cart.items[0] });\n\t\texpect(cartItem.product.toString()).to.be.equal(productId);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;787a498b-988e-48b4-a160-af06eddb8aeb&quot;,&quot;parentUUID&quot;:&quot;b766d581-8283-4519-926a-f9c787a09345&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;787a498b-988e-48b4-a160-af06eddb8aeb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c60bb9f6-915d-4aaa-88c4-bd974fe5f550&quot;,&quot;title&quot;:&quot; DELETE \&quot;/cart-item/\&quot; Remove item from user cart &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\cart-test.js&quot;,&quot;file&quot;:&quot;\\test\\cart-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should remove the product from the cart of an authorized user &quot;,&quot;fullTitle&quot;:&quot; cart system   DELETE \&quot;/cart-item/\&quot; Remove item from user cart   Should remove the product from the cart of an authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const body = {\n\tproduct: productId.toString()\n};\nawait request(app)\n\t.delete(&#x27;/cart-item/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(body)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cart.items).to.be.empty;\n\t\tconst cartItems = await mongoose.connection\n\t\t\t.collection(&#x27;cartitems&#x27;)\n\t\t\t.findOne({});\n\t\texpect(cartItems).to.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b07786a2-1377-4bfe-9f7f-a24806a0a184&quot;,&quot;parentUUID&quot;:&quot;c60bb9f6-915d-4aaa-88c4-bd974fe5f550&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b07786a2-1377-4bfe-9f7f-a24806a0a184&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c3710e77-8931-4cdd-95df-97ff0861f2f3&quot;,&quot;title&quot;:&quot; compiler system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;fullTitle&quot;:&quot; compiler system  \&quot;before all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:491,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;94328626-de8d-4d3a-94ca-a2d90b4c668b&quot;,&quot;parentUUID&quot;:&quot;c3710e77-8931-4cdd-95df-97ff0861f2f3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;fullTitle&quot;:&quot; compiler system  \&quot;after all\&quot; hook in \&quot; compiler system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;compilers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;928df06a-0ecd-4e17-8215-99c693c779e3&quot;,&quot;parentUUID&quot;:&quot;c3710e77-8931-4cdd-95df-97ff0861f2f3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;23fd0416-fd9e-4e4e-9243-7e3a8ea33dbb&quot;,&quot;title&quot;:&quot; POST \&quot;/compiler/\&quot; Create new compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new compiler in database &quot;,&quot;fullTitle&quot;:&quot; compiler system   POST \&quot;/compiler/\&quot; Create new compiler   Should create new compiler in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newCompiler = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/compiler/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newCompiler)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tcompilerId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;38dca0ab-4211-4113-9ca5-072ed56f178f&quot;,&quot;parentUUID&quot;:&quot;23fd0416-fd9e-4e4e-9243-7e3a8ea33dbb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;38dca0ab-4211-4113-9ca5-072ed56f178f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;038fc3c2-c661-4638-96b5-318b802432d4&quot;,&quot;title&quot;:&quot; GET \&quot;/compiler/\&quot; Get all compilers &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all compilers &quot;,&quot;fullTitle&quot;:&quot; compiler system   GET \&quot;/compiler/\&quot; Get all compilers   Should return all compilers &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/compiler/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c3360af0-72f0-4850-a4b7-92a90907e7e2&quot;,&quot;parentUUID&quot;:&quot;038fc3c2-c661-4638-96b5-318b802432d4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c3360af0-72f0-4850-a4b7-92a90907e7e2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d11508c9-4335-490b-b770-306301650cfa&quot;,&quot;title&quot;:&quot; GET \&quot;/compiler/:id\&quot; Get one compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one compiler by id &quot;,&quot;fullTitle&quot;:&quot; compiler system   GET \&quot;/compiler/:id\&quot; Get one compiler   Should return one compiler by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/compiler/${compilerId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e15bedf-d848-4cf4-a812-40e6402f5ed2&quot;,&quot;parentUUID&quot;:&quot;d11508c9-4335-490b-b770-306301650cfa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6e15bedf-d848-4cf4-a812-40e6402f5ed2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;40ead108-a143-4426-8dde-6ef3911f1d55&quot;,&quot;title&quot;:&quot; PATCH \&quot;/compiler/:id\&quot; Update one existing compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one compiler with updated data &quot;,&quot;fullTitle&quot;:&quot; compiler system   PATCH \&quot;/compiler/:id\&quot; Update one existing compiler   Should return one compiler with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedCompilerData = {\n\tfullName: &#x27;Updated compiler name&#x27;\n};\nawait request(app)\n\t.patch(`/compiler/${compilerId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedCompilerData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated compiler name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bcd8fe6a-e8a9-4678-b6da-b4b08c6e010d&quot;,&quot;parentUUID&quot;:&quot;40ead108-a143-4426-8dde-6ef3911f1d55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bcd8fe6a-e8a9-4678-b6da-b4b08c6e010d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2f2ed8ea-c3f3-44da-a90d-a4a1f2a1812f&quot;,&quot;title&quot;:&quot; DELETE \&quot;/compiler/:id\&quot; Delete one compiler &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\compiler-test.js&quot;,&quot;file&quot;:&quot;\\test\\compiler-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark compiler as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; compiler system   DELETE \&quot;/compiler/:id\&quot; Delete one compiler   Should mark compiler as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/compiler/${compilerId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedCompiler = await mongoose.connection\n\t\t\t.collection(&#x27;compilers&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedCompiler.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad327c3e-c9b8-4ca6-9819-3ca259f27f35&quot;,&quot;parentUUID&quot;:&quot;2f2ed8ea-c3f3-44da-a90d-a4a1f2a1812f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ad327c3e-c9b8-4ca6-9819-3ca259f27f35&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f46a697a-834e-4b6e-aafd-af7e41dba57f&quot;,&quot;title&quot;:&quot; country system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\country-test.js&quot;,&quot;file&quot;:&quot;\\test\\country-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;fullTitle&quot;:&quot; country system  \&quot;before all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:520,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5734b6c4-ae5a-4023-bb15-4ed0d1a976d7&quot;,&quot;parentUUID&quot;:&quot;f46a697a-834e-4b6e-aafd-af7e41dba57f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;fullTitle&quot;:&quot; country system  \&quot;after all\&quot; hook in \&quot; country system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;countries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e86ad38-8cfa-4350-8ce7-87bcfdb54850&quot;,&quot;parentUUID&quot;:&quot;f46a697a-834e-4b6e-aafd-af7e41dba57f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f87a9c54-f6b4-4996-b680-643b2ed22944&quot;,&quot;title&quot;:&quot; GET \&quot;/country/\&quot; Get all countries &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\country-test.js&quot;,&quot;file&quot;:&quot;\\test\\country-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; GET \&quot;/country/\&quot; Get all countries \&quot;&quot;,&quot;fullTitle&quot;:&quot; country system   GET \&quot;/country/\&quot; Get all countries  \&quot;before all\&quot; hook in \&quot; GET \&quot;/country/\&quot; Get all countries \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const country = {\n\tname: &#x27;Україна&#x27;,\n\tcities: [&#x27;Одеса&#x27;, &#x27;Житомир&#x27;],\n\tkey: &#x27;ukraine&#x27;\n};\ncountryId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;countries&#x27;)\n\t\t.insertOne(country)\n).insertedId;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9b82becf-6d19-431b-a722-caf46e7a3ad0&quot;,&quot;parentUUID&quot;:&quot;f87a9c54-f6b4-4996-b680-643b2ed22944&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all countries &quot;,&quot;fullTitle&quot;:&quot; country system   GET \&quot;/country/\&quot; Get all countries   Should return all countries &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/country/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9edd2372-140f-43db-b183-247754314979&quot;,&quot;parentUUID&quot;:&quot;f87a9c54-f6b4-4996-b680-643b2ed22944&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9edd2372-140f-43db-b183-247754314979&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2d82552e-6610-4e60-a43c-5fa7fdc88262&quot;,&quot;title&quot;:&quot; GET \&quot;/country/:id\&quot; Get one country &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\country-test.js&quot;,&quot;file&quot;:&quot;\\test\\country-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one country by id &quot;,&quot;fullTitle&quot;:&quot; country system   GET \&quot;/country/:id\&quot; Get one country   Should return one country by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [&#x27;name&#x27;, &#x27;cities&#x27;];\nawait request(app)\n\t.get(`/country/${countryId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4339c5a-31d7-4d6d-b08d-6e82e4f0db04&quot;,&quot;parentUUID&quot;:&quot;2d82552e-6610-4e60-a43c-5fa7fdc88262&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e4339c5a-31d7-4d6d-b08d-6e82e4f0db04&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;67f8ff37-ec18-4966-b4a5-b9ff170f936a&quot;,&quot;title&quot;:&quot; delivery type system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\delivery-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\delivery-type-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; delivery type system  \&quot;before all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:479,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2d7c9b99-7b50-4c3e-b794-10c81b34e0f6&quot;,&quot;parentUUID&quot;:&quot;67f8ff37-ec18-4966-b4a5-b9ff170f936a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; delivery type system  \&quot;after all\&quot; hook in \&quot; delivery type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.deleteMany();\nawait mongoose.connection.collection(&#x27;countries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;efd34722-2b05-4f7b-97a5-254e714e5742&quot;,&quot;parentUUID&quot;:&quot;67f8ff37-ec18-4966-b4a5-b9ff170f936a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;7f48c62a-aa62-4a5f-b5e0-6bdbcce6d36b&quot;,&quot;title&quot;:&quot; GET \&quot;/delivery-type/\&quot; Get all delivery types &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\delivery-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\delivery-type-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; GET \&quot;/delivery-type/\&quot; Get all delivery types \&quot;&quot;,&quot;fullTitle&quot;:&quot; delivery type system   GET \&quot;/delivery-type/\&quot; Get all delivery types  \&quot;before all\&quot; hook in \&quot; GET \&quot;/delivery-type/\&quot; Get all delivery types \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const country = {\n\tname: &#x27;Україна&#x27;,\n\tcities: [&#x27;Одеса&#x27;, &#x27;Житомир&#x27;],\n\tkey: &#x27;ukraine&#x27;\n};\nconst countryId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;countries&#x27;)\n\t\t.insertOne(country)\n).insertedId;\nconst deliveryType = {\n\tname: &#x27;Відділення Нова Пошта&#x27;,\n\tprice: 60,\n\tcountries: [countryId],\n\tcontactInfoRequired: false,\n\tfullAddressRequired: false,\n\tpaymentTypes: [\n\t\t&#x27;Оплата карткою On-line&#x27;,\n\t\t&#x27;Готівкою або карткою: При отриманні&#x27;,\n\t\t&#x27;Передплата: по б/г рахунку (для юр. осіб)&#x27;\n\t],\n\tvariablePrice: false,\n\tkey: &#x27;viddilennya-nova-poshta&#x27;\n};\nawait mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.insertOne(deliveryType);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a84ad4ed-e7f3-48b1-aec6-41894ef153b8&quot;,&quot;parentUUID&quot;:&quot;7f48c62a-aa62-4a5f-b5e0-6bdbcce6d36b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all delivery types &quot;,&quot;fullTitle&quot;:&quot; delivery type system   GET \&quot;/delivery-type/\&quot; Get all delivery types   Should return all delivery types &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/delivery-type/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;).and.not.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ba71b4e-21d8-4fa9-8a5b-15c8c7624a58&quot;,&quot;parentUUID&quot;:&quot;7f48c62a-aa62-4a5f-b5e0-6bdbcce6d36b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5ba71b4e-21d8-4fa9-8a5b-15c8c7624a58&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3df9dc2d-bb09-4d4b-9e5a-51b2e6a9c8f4&quot;,&quot;title&quot;:&quot; editor system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;fullTitle&quot;:&quot; editor system  \&quot;before all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:487,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;164e8343-c604-46c0-9a49-c36f4f9ed36a&quot;,&quot;parentUUID&quot;:&quot;3df9dc2d-bb09-4d4b-9e5a-51b2e6a9c8f4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;fullTitle&quot;:&quot; editor system  \&quot;after all\&quot; hook in \&quot; editor system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;editors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c59874c-196f-4fbc-88c6-440cc8351df1&quot;,&quot;parentUUID&quot;:&quot;3df9dc2d-bb09-4d4b-9e5a-51b2e6a9c8f4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;74716f47-500f-4619-afd9-5a5dc7c41df3&quot;,&quot;title&quot;:&quot; POST \&quot;/editor/\&quot; Create new editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new editor in database &quot;,&quot;fullTitle&quot;:&quot; editor system   POST \&quot;/editor/\&quot; Create new editor   Should create new editor in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newEditor = {\n\tfullName: &#x27;Anna Petrova&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/editor/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newEditor)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\teditorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;28d47da9-9157-45f5-897e-44648e758026&quot;,&quot;parentUUID&quot;:&quot;74716f47-500f-4619-afd9-5a5dc7c41df3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;28d47da9-9157-45f5-897e-44648e758026&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9c4da681-5a3f-4690-b181-31125ecc423f&quot;,&quot;title&quot;:&quot; GET \&quot;/editor/\&quot; Get all editors &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all editors &quot;,&quot;fullTitle&quot;:&quot; editor system   GET \&quot;/editor/\&quot; Get all editors   Should return all editors &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/editor/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;49b79309-92e6-4441-8d48-3f8852a75667&quot;,&quot;parentUUID&quot;:&quot;9c4da681-5a3f-4690-b181-31125ecc423f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;49b79309-92e6-4441-8d48-3f8852a75667&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;628e4ca5-9aee-4f60-9569-63a7a57d2b0d&quot;,&quot;title&quot;:&quot; GET \&quot;/editor/:id\&quot; Get one editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one editor by id  &quot;,&quot;fullTitle&quot;:&quot; editor system   GET \&quot;/editor/:id\&quot; Get one editor   Should return one editor by id  &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/editor/${editorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e7735ca-b006-418a-94d1-c17232c95f47&quot;,&quot;parentUUID&quot;:&quot;628e4ca5-9aee-4f60-9569-63a7a57d2b0d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9e7735ca-b006-418a-94d1-c17232c95f47&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6694baa9-cae0-4804-a872-463154f5eba6&quot;,&quot;title&quot;:&quot; PATCH \&quot;/editor/:id\&quot; Update one existing editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one editor with updated data &quot;,&quot;fullTitle&quot;:&quot; editor system   PATCH \&quot;/editor/:id\&quot; Update one existing editor   Should return one editor with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedEditorData = {\n\tfullName: &#x27;Updated editor name&#x27;\n};\nawait request(app)\n\t.patch(`/editor/${editorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedEditorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated editor name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;65fd9c86-bd2e-4b75-adb4-027bf0616580&quot;,&quot;parentUUID&quot;:&quot;6694baa9-cae0-4804-a872-463154f5eba6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;65fd9c86-bd2e-4b75-adb4-027bf0616580&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3604675b-e56c-4fcd-b523-5857d3ba930a&quot;,&quot;title&quot;:&quot; DELETE \&quot;/editor/:id\&quot; Delete one editor &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\editor-test.js&quot;,&quot;file&quot;:&quot;\\test\\editor-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark editor as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; editor system   DELETE \&quot;/editor/:id\&quot; Delete one editor   Should mark editor as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/editor/${editorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedEditor = await mongoose.connection\n\t\t\t.collection(&#x27;editors&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedEditor.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d249e815-b867-44f7-9f2e-973bfb3c96a2&quot;,&quot;parentUUID&quot;:&quot;3604675b-e56c-4fcd-b523-5857d3ba930a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d249e815-b867-44f7-9f2e-973bfb3c96a2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;124ada19-2b56-485a-a533-f891a5e97c6c&quot;,&quot;title&quot;:&quot; illustrator system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; illustrator system  \&quot;before all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:470,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6595a97b-7b0f-441a-a6bc-b442c4a88512&quot;,&quot;parentUUID&quot;:&quot;124ada19-2b56-485a-a533-f891a5e97c6c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; illustrator system  \&quot;after all\&quot; hook in \&quot; illustrator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;illustrators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c705f87e-4685-4afd-8690-bda926838e5e&quot;,&quot;parentUUID&quot;:&quot;124ada19-2b56-485a-a533-f891a5e97c6c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ddd784d8-8e8a-4ff8-8b46-7f279a1ecac6&quot;,&quot;title&quot;:&quot; POST \&quot;/illustrator/\&quot; Create new illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Shold create new illustrator in database &quot;,&quot;fullTitle&quot;:&quot; illustrator system   POST \&quot;/illustrator/\&quot; Create new illustrator   Shold create new illustrator in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newIllustrator = {\n\tfullName: &#x27;Anna Petrova&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/illustrator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newIllustrator)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tillustratorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d13d4ebe-67c4-4155-aca2-fd59ba3be5fd&quot;,&quot;parentUUID&quot;:&quot;ddd784d8-8e8a-4ff8-8b46-7f279a1ecac6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d13d4ebe-67c4-4155-aca2-fd59ba3be5fd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e67cf328-e6d5-4926-9a63-9b0584e1b482&quot;,&quot;title&quot;:&quot; GET \&quot;/illustrator/\&quot; Get all illustrators &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all illustrators &quot;,&quot;fullTitle&quot;:&quot; illustrator system   GET \&quot;/illustrator/\&quot; Get all illustrators   Should return all illustrators &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/illustrator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e1d5e0c-6036-4e82-a0e1-7d855de0c60b&quot;,&quot;parentUUID&quot;:&quot;e67cf328-e6d5-4926-9a63-9b0584e1b482&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1e1d5e0c-6036-4e82-a0e1-7d855de0c60b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d2918798-d08c-4cad-9648-b3fbce29f4e4&quot;,&quot;title&quot;:&quot; GET \&quot;/illustrator/:id\&quot; Get one illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one illustrator by id &quot;,&quot;fullTitle&quot;:&quot; illustrator system   GET \&quot;/illustrator/:id\&quot; Get one illustrator   Should return one illustrator by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/illustrator/${illustratorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef00d692-f283-4c77-bab1-1df9d668c371&quot;,&quot;parentUUID&quot;:&quot;d2918798-d08c-4cad-9648-b3fbce29f4e4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ef00d692-f283-4c77-bab1-1df9d668c371&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1bcda37c-9818-4cf5-a129-250b64a7e8ce&quot;,&quot;title&quot;:&quot; PATCH \&quot;/illustrator/:id\&quot; Update one existing illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one illustrator with updated data &quot;,&quot;fullTitle&quot;:&quot; illustrator system   PATCH \&quot;/illustrator/:id\&quot; Update one existing illustrator   Should return one illustrator with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedIllustratorData = {\n\tfullName: &#x27;Updated illustrator name&#x27;\n};\nawait request(app)\n\t.patch(`/illustrator/${illustratorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedIllustratorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated illustrator name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;777b8362-5dd7-44cc-bbf5-b8410f4d33af&quot;,&quot;parentUUID&quot;:&quot;1bcda37c-9818-4cf5-a129-250b64a7e8ce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;777b8362-5dd7-44cc-bbf5-b8410f4d33af&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3add433a-6f3e-4897-8d66-1a9470325bfd&quot;,&quot;title&quot;:&quot; DELETE \&quot;/illustrator/:id\&quot; Delete one illustrator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\illustrator-test.js&quot;,&quot;file&quot;:&quot;\\test\\illustrator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark illustrator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; illustrator system   DELETE \&quot;/illustrator/:id\&quot; Delete one illustrator   Should mark illustrator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/illustrator/${illustratorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedIllustrator = await mongoose.connection\n\t\t\t.collection(&#x27;illustrators&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedIllustrator.deletedAt).to.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;755a10a4-4777-4705-9996-c4558ceb86d7&quot;,&quot;parentUUID&quot;:&quot;3add433a-6f3e-4897-8d66-1a9470325bfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;755a10a4-4777-4705-9996-c4558ceb86d7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1d832f06-cb23-43ee-a0cf-df39cb13cc4e&quot;,&quot;title&quot;:&quot; Order system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;fullTitle&quot;:&quot; Order system  \&quot;before all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:474,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0a27a38-c655-44dc-8920-d5e21fa67c75&quot;,&quot;parentUUID&quot;:&quot;1d832f06-cb23-43ee-a0cf-df39cb13cc4e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;fullTitle&quot;:&quot; Order system  \&quot;after all\&quot; hook in \&quot; Order system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;countries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;cartitems&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;orders&#x27;).deleteMany();\nawait mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7afd113-5389-44c3-a924-71f9d241d9c0&quot;,&quot;parentUUID&quot;:&quot;1d832f06-cb23-43ee-a0cf-df39cb13cc4e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;46cb6f03-ab57-4623-bc0d-473e9be1d6bd&quot;,&quot;title&quot;:&quot; POST \&quot;/order/\&quot; Create new order &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; POST \&quot;/order/\&quot; Create new order \&quot;&quot;,&quot;fullTitle&quot;:&quot; Order system   POST \&quot;/order/\&quot; Create new order  \&quot;before all\&quot; hook in \&quot; POST \&quot;/order/\&quot; Create new order \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const country = {\n\tname: &#x27;Україна&#x27;,\n\tcities: [&#x27;Одеса&#x27;, &#x27;Житомир&#x27;],\n\tkey: &#x27;ukraine&#x27;\n};\nconst countryId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;countries&#x27;)\n\t\t.insertOne(country)\n).insertedId;\nconst deliveryType = {\n\tname: \&quot;Кур&#x27;єр Нова Пошта\&quot;,\n\tprice: 60,\n\tcountries: [countryId],\n\tcontactInfoRequired: false,\n\tfullAddressRequired: false,\n\tpaymentTypes: [\n\t\t&#x27;Оплата карткою On-line&#x27;,\n\t\t&#x27;Готівкою або карткою: При отриманні&#x27;,\n\t\t&#x27;Передплата: по б/г рахунку (для юр. осіб)&#x27;\n\t],\n\tvariablePrice: false,\n\tkey: &#x27;viddilennya-nova-poshta&#x27;\n};\nawait mongoose.connection\n\t.collection(&#x27;deliverytypes&#x27;)\n\t.insertOne(deliveryType);\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcode: &#x27;1023022&#x27;\n};\nproductId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;products&#x27;)\n\t\t.insertOne(product)\n).insertedId;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0fab02b8-1e70-46f8-ae22-fdd446b64ced&quot;,&quot;parentUUID&quot;:&quot;46cb6f03-ab57-4623-bc0d-473e9be1d6bd&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should register a new user and create an order. Also send 2 emails &quot;,&quot;fullTitle&quot;:&quot; Order system   POST \&quot;/order/\&quot; Create new order   Should register a new user and create an order. Also send 2 emails &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6500,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;this.timeout(10000);\nconst order = {\n\tcontactInfo: {\n\t\tfirstName: &#x27;Микола&#x27;,\n\t\tlastName: &#x27;Пшеничний&#x27;,\n\t\tphoneNumber: &#x27;+380687744321&#x27;,\n\t\temail: &#x27;jorobe6702@dronetz.com&#x27;\n\t},\n\tgift: false,\n\tcallback: true,\n\tdeliveryInfo: {\n\t\tcountry: &#x27;Україна&#x27;,\n\t\tcity: &#x27;Київ&#x27;,\n\t\ttype: \&quot;Кур&#x27;єр Нова Пошта\&quot;,\n\t\taddress: &#x27;вул. Шевченка, 10&#x27;\n\t},\n\tpaymentType: &#x27;Готівкою або карткою: При отриманні&#x27;,\n\titems: [{ product: productId, quantity: 3 }]\n};\nawait request(app)\n\t.post(&#x27;/order/&#x27;)\n\t.send(order)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(201);\n\t\tconst user = await mongoose.connection\n\t\t\t.collection(&#x27;users&#x27;)\n\t\t\t.findOne({ role: { $ne: &#x27;admin&#x27; } });\n\t\texpect(user).to.not.be.null;\n\t\tconst cart = await mongoose.connection\n\t\t\t.collection(&#x27;carts&#x27;)\n\t\t\t.findOne({ _id: user.cart });\n\t\texpect(cart).to.not.be.null;\n\t\tconst order = await mongoose.connection\n\t\t\t.collection(&#x27;orders&#x27;)\n\t\t\t.findOne({});\n\t\texpect(order).to.not.be.null;\n\t\texpect(order.user.toString()).to.be.equal(\n\t\t\tuser._id.toString()\n\t\t);\n\t\torderId = order._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;454a959b-19f0-4f52-8b1f-bb92a35ab8f5&quot;,&quot;parentUUID&quot;:&quot;46cb6f03-ab57-4623-bc0d-473e9be1d6bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;454a959b-19f0-4f52-8b1f-bb92a35ab8f5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6500,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f177e910-b842-4d88-ae5d-4fbfc7439897&quot;,&quot;title&quot;:&quot; GET \&quot;/order/\&quot; Get all orders &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all orders &quot;,&quot;fullTitle&quot;:&quot; Order system   GET \&quot;/order/\&quot; Get all orders   Should return all orders &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/order/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;).and.not.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;467acf0f-c791-4d7f-80c9-fb609484ae8b&quot;,&quot;parentUUID&quot;:&quot;f177e910-b842-4d88-ae5d-4fbfc7439897&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;467acf0f-c791-4d7f-80c9-fb609484ae8b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;60846d82-95db-49e7-981a-5ccfa64e4d96&quot;,&quot;title&quot;:&quot; GET \&quot;/order/statuses\&quot; Get all order statuses &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all order statuses&quot;,&quot;fullTitle&quot;:&quot; Order system   GET \&quot;/order/statuses\&quot; Get all order statuses   Should return all order statuses&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/order/statuses/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;).and.not.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84abb22e-2529-4685-aea8-adfa5aa59c8b&quot;,&quot;parentUUID&quot;:&quot;60846d82-95db-49e7-981a-5ccfa64e4d96&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;84abb22e-2529-4685-aea8-adfa5aa59c8b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e83c5494-0afd-4240-972f-4f20c6cbf71b&quot;,&quot;title&quot;:&quot; GET \&quot;/order/:id\&quot; Get one order &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one order by id &quot;,&quot;fullTitle&quot;:&quot; Order system   GET \&quot;/order/:id\&quot; Get one order   Should return one order by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/order/${orderId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;object&#x27;).and.not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a9b6933-cd59-4bba-9e76-95859c96ed33&quot;,&quot;parentUUID&quot;:&quot;e83c5494-0afd-4240-972f-4f20c6cbf71b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9a9b6933-cd59-4bba-9e76-95859c96ed33&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;85d9f6c8-a7c7-40c9-bf48-fd7b4ff1fc2c&quot;,&quot;title&quot;:&quot; PATCH \&quot;/order/status/:id\&quot; Update status of one existing order &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\order-test.js&quot;,&quot;file&quot;:&quot;\\test\\order-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one order by id with updated status &quot;,&quot;fullTitle&quot;:&quot; Order system   PATCH \&quot;/order/status/:id\&quot; Update status of one existing order   Should return one order by id with updated status &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const status = await mongoose.connection\n\t.collection(&#x27;order_statuses&#x27;)\n\t.findOne({ name: &#x27;Виконаний&#x27; });\nawait request(app)\n\t.patch(`/order/status/${orderId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send({ status: status._id })\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\tconst order = await mongoose.connection\n\t\t\t.collection(&#x27;orders&#x27;)\n\t\t\t.findOne({});\n\t\texpect(order.status.name).to.be.equal(&#x27;Виконаний&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;05c6fce1-72a8-46f7-b6d6-6e84f8534609&quot;,&quot;parentUUID&quot;:&quot;85d9f6c8-a7c7-40c9-bf48-fd7b4ff1fc2c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;05c6fce1-72a8-46f7-b6d6-6e84f8534609&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5f086cbe-b229-41c7-b1e1-05924fc987e1&quot;,&quot;title&quot;:&quot; product system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product system  \&quot;before all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:498,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6bc63cf9-0114-48a3-951a-daa71a5ff249&quot;,&quot;parentUUID&quot;:&quot;5f086cbe-b229-41c7-b1e1-05924fc987e1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product system  \&quot;after all\&quot; hook in \&quot; product system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;books&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;bookseries&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;compilers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;editors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;illustrators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;translators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff595c2d-c93c-4030-80d7-7a6e818adbd6&quot;,&quot;parentUUID&quot;:&quot;5f086cbe-b229-41c7-b1e1-05924fc987e1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;71e59cce-50eb-411d-9b9d-40c9d7eb3799&quot;,&quot;title&quot;:&quot; GET \&quot;/product/\&quot; Create new product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add new product to database. The value of the \&quot;currentProductsQuantity\&quot; property of the \&quot;products_quantity\&quot; collection should increase&quot;,&quot;fullTitle&quot;:&quot; product system   GET \&quot;/product/\&quot; Create new product   Should add new product to database. The value of the \&quot;currentProductsQuantity\&quot; property of the \&quot;products_quantity\&quot; collection should increase&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst author = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbiography:\n\t\t&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nawait mongoose.connection\n\t.collection(&#x27;authors&#x27;)\n\t.insertOne(author);\nconst authorName = (\n\tawait mongoose.connection.collection(&#x27;authors&#x27;).findOne({})\n).fullName;\n//#endregion\nconst oldProductsQuantity = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;products_quantity&#x27;)\n\t\t.findOne({})\n).currentProductsQuantity;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;key&#x27;,\n\t&#x27;price&#x27;,\n\t&#x27;quantity&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;sections&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;images&#x27;,\n\t&#x27;creators&#x27;,\n\t&#x27;requiresDelivery&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;code&#x27;\n];\nawait request(app)\n\t.post(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(product)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tconst newProductsQuantity = (\n\t\t\tawait mongoose.connection\n\t\t\t\t.collection(&#x27;products_quantity&#x27;)\n\t\t\t\t.findOne({})\n\t\t).currentProductsQuantity;\n\t\texpect(newProductsQuantity).to.be.above(\n\t\t\toldProductsQuantity\n\t\t);\n\t\tproductId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b09c053-4f17-43fa-b0fc-3b3bb1327a24&quot;,&quot;parentUUID&quot;:&quot;71e59cce-50eb-411d-9b9d-40c9d7eb3799&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0b09c053-4f17-43fa-b0fc-3b3bb1327a24&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:21,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3f09b469-c78c-48ac-9762-7bb89f596a66&quot;,&quot;title&quot;:&quot; GET \&quot;/product/\&quot; Get all products &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all products &quot;,&quot;fullTitle&quot;:&quot; product system   GET \&quot;/product/\&quot; Get all products   Should return all products &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.result).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e80ba890-94ee-47d0-a208-4bcb6a54ca78&quot;,&quot;parentUUID&quot;:&quot;3f09b469-c78c-48ac-9762-7bb89f596a66&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e80ba890-94ee-47d0-a208-4bcb6a54ca78&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fd945a8b-7d38-47a2-b034-65672883e24d&quot;,&quot;title&quot;:&quot; GET \&quot;/product/:id\&quot; Get one product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one product by id &quot;,&quot;fullTitle&quot;:&quot; product system   GET \&quot;/product/:id\&quot; Get one product   Should return one product by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;key&#x27;,\n\t&#x27;price&#x27;,\n\t&#x27;quantity&#x27;,\n\t&#x27;type&#x27;,\n\t&#x27;sections&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;images&#x27;,\n\t&#x27;creators&#x27;,\n\t&#x27;requiresDelivery&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;code&#x27;\n];\nawait request(app)\n\t.get(`/product/${productId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;337109cb-164c-4fe8-b9eb-2bd999a3ce9e&quot;,&quot;parentUUID&quot;:&quot;fd945a8b-7d38-47a2-b034-65672883e24d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;337109cb-164c-4fe8-b9eb-2bd999a3ce9e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;303050ab-18c4-44ef-87c9-3046b8f0508a&quot;,&quot;title&quot;:&quot; PATCH \&quot;/product/:id\&quot; Update one existing product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return product with updated data  &quot;,&quot;fullTitle&quot;:&quot; product system   PATCH \&quot;/product/:id\&quot; Update one existing product   Should return product with updated data  &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedProductData = {\n\tprice: 1000,\n\tquantity: 3\n};\nawait request(app)\n\t.patch(`/product/${productId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedProductData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.price).to.equal(\n\t\t\tupdatedProductData.price\n\t\t);\n\t\texpect(response.body.quantity).to.equal(\n\t\t\tupdatedProductData.quantity\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af185b3c-8624-4650-932b-99b08884625f&quot;,&quot;parentUUID&quot;:&quot;303050ab-18c4-44ef-87c9-3046b8f0508a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;af185b3c-8624-4650-932b-99b08884625f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a9347ce6-eae0-4e74-a544-0a4e4bf971aa&quot;,&quot;title&quot;:&quot; DELETE \&quot;/prodcut/:id\&quot; Delete one product &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; product system   DELETE \&quot;/prodcut/:id\&quot; Delete one product   Should mark product as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region add necessary dependencies\nconst publisher = {\n\tname: &#x27;Квітка&#x27;,\n\tbooks: [],\n\tbookSeries: []\n};\nconst publisherId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;publishers&#x27;)\n\t\t.insertOne(publisher)\n).insertedId;\nconst book = {\n\tproduct: productId,\n\tpublisher: publisherId,\n\tlanguages: [&#x27;Українська&#x27;],\n\ttype: &#x27;Паперова&#x27;,\n\tpublishedIn: 1994\n};\nawait request(app)\n\t.post(&#x27;/book/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(book);\n//#endregion\nawait request(app)\n\t.delete(`/product/${productId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst product = await mongoose.connection\n\t\t\t.collection(&#x27;products&#x27;)\n\t\t\t.findOne({});\n\t\texpect(product.deletedAt).to.be.not.null;\n\t\tconst book = await mongoose.connection\n\t\t\t.collection(&#x27;books&#x27;)\n\t\t\t.findOne({});\n\t\texpect(book.deletedAt).to.be.not.null;\n\t\tconst section = await mongoose.connection\n\t\t\t.collection(&#x27;sections&#x27;)\n\t\t\t.findOne({});\n\t\texpect(section.products).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b863b8e-8d65-422e-89c5-904560396672&quot;,&quot;parentUUID&quot;:&quot;a9347ce6-eae0-4e74-a544-0a4e4bf971aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1b863b8e-8d65-422e-89c5-904560396672&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:50,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9391259b-28d5-4bb0-bb7a-4207fdf1747b&quot;,&quot;title&quot;:&quot; product-type system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product-type system  \&quot;before all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:500,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af1d5aef-ab3f-4770-b05d-2174dd6241b6&quot;,&quot;parentUUID&quot;:&quot;9391259b-28d5-4bb0-bb7a-4207fdf1747b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;fullTitle&quot;:&quot; product-type system  \&quot;after all\&quot; hook in \&quot; product-type system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10d99e6c-b98b-4d14-888c-cc44a60cf2e7&quot;,&quot;parentUUID&quot;:&quot;9391259b-28d5-4bb0-bb7a-4207fdf1747b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d78d90bb-7a28-4a7a-ba56-c9df71a8db74&quot;,&quot;title&quot;:&quot; POST \&quot;/product-type/\&quot; Create new product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add new product type to database &quot;,&quot;fullTitle&quot;:&quot; product-type system   POST \&quot;/product-type/\&quot; Create new product type   Should add new product type to database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newProductType = {\n\tname: &#x27;Book&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/product-type/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newProductType)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tproductTypeId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dbbe6754-4c8f-419d-8c32-670425befd50&quot;,&quot;parentUUID&quot;:&quot;d78d90bb-7a28-4a7a-ba56-c9df71a8db74&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dbbe6754-4c8f-419d-8c32-670425befd50&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;393055f9-b180-408a-b69b-817d844b4f1f&quot;,&quot;title&quot;:&quot; GET \&quot;/product-type/\&quot; Get all product types &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all product types &quot;,&quot;fullTitle&quot;:&quot; product-type system   GET \&quot;/product-type/\&quot; Get all product types   Should return all product types &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/product-type/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e096bed-d5f4-40b5-bc9c-03c7b1e930c1&quot;,&quot;parentUUID&quot;:&quot;393055f9-b180-408a-b69b-817d844b4f1f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6e096bed-d5f4-40b5-bc9c-03c7b1e930c1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ff621f32-9055-435b-852a-8d75c172575a&quot;,&quot;title&quot;:&quot; GET \&quot;/product-type/:id\&quot; Get one product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one product type by id &quot;,&quot;fullTitle&quot;:&quot; product-type system   GET \&quot;/product-type/:id\&quot; Get one product type   Should return one product type by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/product-type/${productTypeId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c48c670-3df2-4f8b-91f9-ba1396b709bb&quot;,&quot;parentUUID&quot;:&quot;ff621f32-9055-435b-852a-8d75c172575a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0c48c670-3df2-4f8b-91f9-ba1396b709bb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7cafa64a-c072-4135-87d8-108d7ac5610b&quot;,&quot;title&quot;:&quot; PATCH \&quot;/product-type/:id\&quot; Update one existing product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return product type with updated data &quot;,&quot;fullTitle&quot;:&quot; product-type system   PATCH \&quot;/product-type/:id\&quot; Update one existing product type   Should return product type with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedProductTypeData = {\n\tname: &#x27;E-Book&#x27;,\n\tkey: &#x27;e-book&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.patch(`/product-type/${productTypeId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedProductTypeData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f926160-5a91-43f8-8385-1d54f1d0ad44&quot;,&quot;parentUUID&quot;:&quot;7cafa64a-c072-4135-87d8-108d7ac5610b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6f926160-5a91-43f8-8385-1d54f1d0ad44&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a40ecfa7-bdc5-489f-9333-79f05b85c895&quot;,&quot;title&quot;:&quot; DELETE \&quot;/prodcut-type/:id\&quot; Delete one product type &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\product-type-test.js&quot;,&quot;file&quot;:&quot;\\test\\product-type-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should delete one product type from database &quot;,&quot;fullTitle&quot;:&quot; product-type system   DELETE \&quot;/prodcut-type/:id\&quot; Delete one product type   Should delete one product type from database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/product-type/${productTypeId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst productTypeObject = await mongoose.connection\n\t\t\t.collection(&#x27;producttypes&#x27;)\n\t\t\t.findOne();\n\t\texpect(productTypeObject).to.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd4b32f5-119a-4a7d-8c4a-51b9c988d9f9&quot;,&quot;parentUUID&quot;:&quot;a40ecfa7-bdc5-489f-9333-79f05b85c895&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fd4b32f5-119a-4a7d-8c4a-51b9c988d9f9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;52f63b34-2ed9-461e-a967-1f781ac2b20d&quot;,&quot;title&quot;:&quot; publisher system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;fullTitle&quot;:&quot; publisher system  \&quot;before all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:511,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3cb98306-7cf7-4c42-8b55-93f688ce9d73&quot;,&quot;parentUUID&quot;:&quot;52f63b34-2ed9-461e-a967-1f781ac2b20d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;fullTitle&quot;:&quot; publisher system  \&quot;after all\&quot; hook in \&quot; publisher system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;publishers&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bb98b2a8-bbe7-4f62-9cc5-b538ac5289f5&quot;,&quot;parentUUID&quot;:&quot;52f63b34-2ed9-461e-a967-1f781ac2b20d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;896c533d-1a2f-48f8-8d47-6626d575d1ce&quot;,&quot;title&quot;:&quot; POST \&quot;/publisher/\&quot; Create new publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new publisher &quot;,&quot;fullTitle&quot;:&quot; publisher system   POST \&quot;/publisher/\&quot; Create new publisher   Should create new publisher &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newPublisher = {\n\tname: &#x27;OpenAI&#x27;,\n\tbooks: [],\n\tbookSeries: [],\n\tdescription: &#x27;Publishing company specializing in AI research&#x27;,\n\tlogo: &#x27;https://example.com/logo.png&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;bookSeries&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/publisher/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newPublisher)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tpublisherId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;322e86b8-1b6d-45e0-9845-3b8db40518f4&quot;,&quot;parentUUID&quot;:&quot;896c533d-1a2f-48f8-8d47-6626d575d1ce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;322e86b8-1b6d-45e0-9845-3b8db40518f4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b2c315b5-d35b-4a29-a99a-1ffc0b8c24ff&quot;,&quot;title&quot;:&quot; GET \&quot;/publisher/\&quot; Get all publishers &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return fll publishers &quot;,&quot;fullTitle&quot;:&quot; publisher system   GET \&quot;/publisher/\&quot; Get all publishers   Should return fll publishers &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/publisher/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8feca68-ae35-4ba7-b95e-b758a026da90&quot;,&quot;parentUUID&quot;:&quot;b2c315b5-d35b-4a29-a99a-1ffc0b8c24ff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c8feca68-ae35-4ba7-b95e-b758a026da90&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0e304c62-f234-4a46-8753-62338fc5384f&quot;,&quot;title&quot;:&quot; GET \&quot;/publisher/:id\&quot; Get one publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one publisher by id &quot;,&quot;fullTitle&quot;:&quot; publisher system   GET \&quot;/publisher/:id\&quot; Get one publisher   Should return one publisher by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;bookSeries&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/publisher/${publisherId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;51591aee-0b97-4b71-b892-de8cf4222dc7&quot;,&quot;parentUUID&quot;:&quot;0e304c62-f234-4a46-8753-62338fc5384f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;51591aee-0b97-4b71-b892-de8cf4222dc7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9729697a-5b51-4b14-8d3e-ead29fe83859&quot;,&quot;title&quot;:&quot; PATCH \&quot;/publisher/:id\&quot; Update one existing publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one publisher with updated data &quot;,&quot;fullTitle&quot;:&quot; publisher system   PATCH \&quot;/publisher/:id\&quot; Update one existing publisher   Should return one publisher with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedPublisherData = {\n\tname: &#x27;Updated Publisher&#x27;,\n\tdescription:\n\t\t&#x27;This is an updated description with more than 40 characters.&#x27;,\n\tlogo: &#x27;https://example.com/updated-logo.png&#x27;\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;bookSeries&#x27;,\n\t&#x27;description&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.patch(`/publisher/${publisherId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedPublisherData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e9942b4-9735-48ce-92cc-0d0fb9f472f4&quot;,&quot;parentUUID&quot;:&quot;9729697a-5b51-4b14-8d3e-ead29fe83859&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9e9942b4-9735-48ce-92cc-0d0fb9f472f4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a595085e-4f41-4f62-a4d6-9458f376d493&quot;,&quot;title&quot;:&quot; DELETE \&quot;/publisher/:id\&quot; Delete one publisher &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\publisher-test.js&quot;,&quot;file&quot;:&quot;\\test\\publisher-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; publisher system   DELETE \&quot;/publisher/:id\&quot; Delete one publisher   Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/publisher/${publisherId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst publisher = await mongoose.connection\n\t\t\t.collection(&#x27;publishers&#x27;)\n\t\t\t.findOne({});\n\t\texpect(publisher.deletedAt).to.be.not.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;11a1caea-6a21-46ff-8dc3-b7d64db01511&quot;,&quot;parentUUID&quot;:&quot;a595085e-4f41-4f62-a4d6-9458f376d493&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;11a1caea-6a21-46ff-8dc3-b7d64db01511&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7231fe16-f46b-4167-a157-726e0b1781ff&quot;,&quot;title&quot;:&quot; review system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;fullTitle&quot;:&quot; review system  \&quot;before all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:533,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;70db817a-dabc-436e-b792-0dfe3575d819&quot;,&quot;parentUUID&quot;:&quot;7231fe16-f46b-4167-a157-726e0b1781ff&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;fullTitle&quot;:&quot; review system  \&quot;after all\&quot; hook in \&quot; review system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;reviews&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19c14587-ae4a-4751-81c7-5150ed7ff892&quot;,&quot;parentUUID&quot;:&quot;7231fe16-f46b-4167-a157-726e0b1781ff&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;261f4789-e6a2-4344-bf3c-32ac29284ad1&quot;,&quot;title&quot;:&quot; POST \&quot;/review/\&quot; Create new review &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new review &quot;,&quot;fullTitle&quot;:&quot; review system   POST \&quot;/review/\&quot; Create new review   Should create new review &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tdeliveryPrice: 60,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tmodel: &#x27;Book&#x27;\n};\nconst productId = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product)\n).body._id;\nconst userId = (\n\tawait mongoose.connection.collection(&#x27;users&#x27;).findOne({})\n)._id;\n//#endregion\nconst review = {\n\tproduct: productId,\n\tuser: userId,\n\ttitle: &#x27;Приголомшлива книжкова подорож&#x27;,\n\ttext: &#x27;Ця книга змушує вас погрузнутися у захопливий світ, де кожна сторінка відкриває нові глибини емоцій та незабутніх пригод. Ви не зможете відірвати очі від її сторінок, а кожне речення залишить слід у вашому серці.&#x27;,\n\trating: 5\n};\nconst expectedFields = [\n\t&#x27;product&#x27;,\n\t&#x27;user&#x27;,\n\t&#x27;title&#x27;,\n\t&#x27;text&#x27;,\n\t&#x27;likes&#x27;,\n\t&#x27;dislikes&#x27;,\n\t&#x27;rating&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/review/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(review)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\treviewId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01782c93-a456-4feb-b171-a036e4716528&quot;,&quot;parentUUID&quot;:&quot;261f4789-e6a2-4344-bf3c-32ac29284ad1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;01782c93-a456-4feb-b171-a036e4716528&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:30,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;dddcd369-a03f-4b71-908e-9a5168777519&quot;,&quot;title&quot;:&quot; PATCH \&quot;/review/:id\&quot; Update one existing review &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one section with updated data &quot;,&quot;fullTitle&quot;:&quot; review system   PATCH \&quot;/review/:id\&quot; Update one existing review   Should return one section with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedReviewData = {\n\ttitle: &#x27;Приголомшлива подорож.&#x27;\n};\nawait request(app)\n\t.patch(`/review/${reviewId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedReviewData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.title).to.be.equal(\n\t\t\t&#x27;Приголомшлива подорож.&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63d8ce23-e732-4706-a5d8-f92b7ba29a24&quot;,&quot;parentUUID&quot;:&quot;dddcd369-a03f-4b71-908e-9a5168777519&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;63d8ce23-e732-4706-a5d8-f92b7ba29a24&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ae5a8ef6-6ca9-4c92-9397-8ae179dce284&quot;,&quot;title&quot;:&quot; DELETE \&quot;/review/:id\&quot; Delete one review &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\review-test.js&quot;,&quot;file&quot;:&quot;\\test\\review-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark review as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; review system   DELETE \&quot;/review/:id\&quot; Delete one review   Should mark review as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/review/${reviewId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst review = await mongoose.connection\n\t\t\t.collection(&#x27;reviews&#x27;)\n\t\t\t.findOne({});\n\t\texpect(review.deletedAt).to.be.not.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b1a8cc3-eb7f-4408-bbb7-7f9b8f51652a&quot;,&quot;parentUUID&quot;:&quot;ae5a8ef6-6ca9-4c92-9397-8ae179dce284&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3b1a8cc3-eb7f-4408-bbb7-7f9b8f51652a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4eacee41-df29-4393-b61f-c54cca82af29&quot;,&quot;title&quot;:&quot; serach system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\search-test.js&quot;,&quot;file&quot;:&quot;\\test\\search-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;fullTitle&quot;:&quot; serach system  \&quot;before all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:526,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;45ad386a-1089-4334-aa22-f419f9e978e2&quot;,&quot;parentUUID&quot;:&quot;4eacee41-df29-4393-b61f-c54cca82af29&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;fullTitle&quot;:&quot; serach system  \&quot;after all\&quot; hook in \&quot; serach system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;authors&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;122da1ae-f0e4-4874-a0db-6c40abd22f54&quot;,&quot;parentUUID&quot;:&quot;4eacee41-df29-4393-b61f-c54cca82af29&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b45018f1-8ab1-40d6-b6f5-0c39983e242d&quot;,&quot;title&quot;:&quot;GET \&quot;/search?q=\&quot; Search for product(s) &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\search-test.js&quot;,&quot;file&quot;:&quot;\\test\\search-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;GET \&quot;/search?q=\&quot; Search for product(s) \&quot;&quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)  \&quot;before all\&quot; hook in \&quot;GET \&quot;/search?q=\&quot; Search for product(s) \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:67,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst author = {\n\tfullName: &#x27;John Smith&#x27;,\n\tbiography:\n\t\t&#x27;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#x27;,\n\tbooks: [],\n\tpictures: [&#x27;picture1.jpg&#x27;, &#x27;picture2.jpg&#x27;]\n};\nawait mongoose.connection\n\t.collection(&#x27;authors&#x27;)\n\t.insertOne(author);\nconst authorName = (\n\tawait mongoose.connection.collection(&#x27;authors&#x27;).findOne({})\n).fullName;\nconst product1 = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst product2 = {\n\tname: &#x27;Мистецтво говорити. Таємниці ефективного спілкування&#x27;,\n\ttype: productTypeId,\n\tprice: 80,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;Бізнес-тренер Джеймс Борґ, відомий своїми відкриттями в галузях спілкування, особистісного розвитку, мови тіла та «контролю мислення», пропонує прості і дієві поради для кожної людини. &#x27;,\n\timages: [&#x27;image2.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nconst product3 = {\n\tname: &#x27;48 законів влади&#x27;,\n\ttype: productTypeId,\n\tprice: 99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;Сорок вісім хитрих, безжальних, повчальних законів влади від Роберта Гріна, які стануть у пригоді кожному, хто прагне досягати вершин.&#x27;,\n\timages: [&#x27;image3.png&#x27;],\n\tsections: [sectionId],\n\tcreators: [authorName]\n};\nproduct1Code = (\n\tawait request(app)\n\t\t.post(&#x27;/product/&#x27;)\n\t\t.set(&#x27;Authorization&#x27;, userToken)\n\t\t.send(product1)\n).body.code;\nawait request(app)\n\t.post(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(product2);\nawait request(app)\n\t.post(&#x27;/product/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(product3);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5009ee16-8511-4417-b7d8-7c18525383a4&quot;,&quot;parentUUID&quot;:&quot;b45018f1-8ab1-40d6-b6f5-0c39983e242d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return three poducts with entered author &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return three poducts with entered author &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/search?q=${&#x27;John Smith&#x27;}`)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(3);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;11de99db-756f-4c4e-b45c-6fa93a5f4a78&quot;,&quot;parentUUID&quot;:&quot;b45018f1-8ab1-40d6-b6f5-0c39983e242d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot; Should return three products with an incomplete entered author &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return three products with an incomplete entered author &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/search?q=${&#x27;Joh&#x27;}`)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(3);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;46206bea-161b-48e0-9528-ae3c10e084e6&quot;,&quot;parentUUID&quot;:&quot;b45018f1-8ab1-40d6-b6f5-0c39983e242d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot; Should return one product with entered product code &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return one product with entered product code &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/search?q=${product1Code}`)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(1);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;896d2dc8-cd98-4448-a618-57d06bf557a1&quot;,&quot;parentUUID&quot;:&quot;b45018f1-8ab1-40d6-b6f5-0c39983e242d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot; Should return one product with an incomplete entered product name &quot;,&quot;fullTitle&quot;:&quot; serach system  GET \&quot;/search?q=\&quot; Search for product(s)   Should return one product with an incomplete entered product name &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(\n\t\t`/search?q=${encodeURIComponent(\n\t\t\t&#x27;Мистецтво говорити. Таємниці ефективного спілкування&#x27;\n\t\t)}`\n\t)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.be.equal(200);\n\t\texpect(response.body.result).to.not.be.empty;\n\t\texpect(response.body.total).to.be.equal(1);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00f67688-ee44-477b-8c47-25c43101a001&quot;,&quot;parentUUID&quot;:&quot;b45018f1-8ab1-40d6-b6f5-0c39983e242d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;11de99db-756f-4c4e-b45c-6fa93a5f4a78&quot;,&quot;46206bea-161b-48e0-9528-ae3c10e084e6&quot;,&quot;896d2dc8-cd98-4448-a618-57d06bf557a1&quot;,&quot;00f67688-ee44-477b-8c47-25c43101a001&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:29,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8c1ad8d5-c6d4-49ce-be4e-68032c5b99c0&quot;,&quot;title&quot;:&quot; section system&quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;fullTitle&quot;:&quot; section system \&quot;before all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:486,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3432fd73-e465-4c3e-937a-d9c11dcc0418&quot;,&quot;parentUUID&quot;:&quot;8c1ad8d5-c6d4-49ce-be4e-68032c5b99c0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;fullTitle&quot;:&quot; section system \&quot;after all\&quot; hook in \&quot; section system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd5f839a-0225-4625-8d00-c5921682b1b8&quot;,&quot;parentUUID&quot;:&quot;8c1ad8d5-c6d4-49ce-be4e-68032c5b99c0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;92ffa446-b9c0-4552-a221-6c8d38abc83d&quot;,&quot;title&quot;:&quot; POST \&quot;/section/\&quot; Create new section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add new section to database &quot;,&quot;fullTitle&quot;:&quot; section system  POST \&quot;/section/\&quot; Create new section   Should add new section to database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const section = {\n\tname: &#x27;Художня література&#x27;,\n\tkey: &#x27;khudozhnia-literatura&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst expectedFields = [\n\t&#x27;name&#x27;,\n\t&#x27;key&#x27;,\n\t&#x27;products&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;sections&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/section/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(section)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\tsectionId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b633d0b-29da-4fa4-a41d-e31472a52481&quot;,&quot;parentUUID&quot;:&quot;92ffa446-b9c0-4552-a221-6c8d38abc83d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5b633d0b-29da-4fa4-a41d-e31472a52481&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d29b8791-21dd-43a2-b2d8-f7c0068f037b&quot;,&quot;title&quot;:&quot; GET \&quot;/section/\&quot; Get all sections &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all sections  &quot;,&quot;fullTitle&quot;:&quot; section system  GET \&quot;/section/\&quot; Get all sections   Should return all sections  &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/section/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1c9fffd-b84f-4e71-a5d5-8bc76c906882&quot;,&quot;parentUUID&quot;:&quot;d29b8791-21dd-43a2-b2d8-f7c0068f037b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c1c9fffd-b84f-4e71-a5d5-8bc76c906882&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;64960b23-7e27-4d49-8faf-d98a0dce7033&quot;,&quot;title&quot;:&quot; GET \&quot;/section/:id\&quot; Get one section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one section by id &quot;,&quot;fullTitle&quot;:&quot; section system  GET \&quot;/section/:id\&quot; Get one section   Should return one section by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [&#x27;name&#x27;, &#x27;key&#x27;, &#x27;_id&#x27;, &#x27;sections&#x27;];\nawait request(app)\n\t.get(`/section/${sectionId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77a682a2-4705-406a-99d3-ea04e01f447d&quot;,&quot;parentUUID&quot;:&quot;64960b23-7e27-4d49-8faf-d98a0dce7033&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;77a682a2-4705-406a-99d3-ea04e01f447d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ad5605ae-984e-40fb-826e-b5807970d2e5&quot;,&quot;title&quot;:&quot; PATCH \&quot;/section/:id\&quot; Update one existing section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return updated section &quot;,&quot;fullTitle&quot;:&quot; section system  PATCH \&quot;/section/:id\&quot; Update one existing section   Should return updated section &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst newSection = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst newSectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(newSection)\n).insertedId;\n//#endregion\nconst updatedSectionData = {\n\tsections: [newSectionId]\n};\nawait request(app)\n\t.patch(`/section/${sectionId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedSectionData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.sections).to.include(\n\t\t\tnewSectionId.toString()\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67ce6ee9-5c2b-4b21-b90a-2e2a3b91dd7c&quot;,&quot;parentUUID&quot;:&quot;ad5605ae-984e-40fb-826e-b5807970d2e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;67ce6ee9-5c2b-4b21-b90a-2e2a3b91dd7c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;16e75eed-263d-4342-9491-3de895d5792b&quot;,&quot;title&quot;:&quot; GET \&quot;/section/:id/products\&quot; Get all section products &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all section products &quot;,&quot;fullTitle&quot;:&quot; section system  GET \&quot;/section/:id/products\&quot; Get all section products   Should return all section products &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/section/${sectionId}/products`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.result).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;848f7ecc-9693-4b0e-a863-6149458a2839&quot;,&quot;parentUUID&quot;:&quot;16e75eed-263d-4342-9491-3de895d5792b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;848f7ecc-9693-4b0e-a863-6149458a2839&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fdac8cd6-c61a-4eaf-b25f-a52d4215e7da&quot;,&quot;title&quot;:&quot; DELETE \&quot;/section/:id\&quot; Delete one section &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\section-test.js&quot;,&quot;file&quot;:&quot;\\test\\section-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; section system  DELETE \&quot;/section/:id\&quot; Delete one section   Should mark section as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/section/${sectionId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst section = await mongoose.connection\n\t\t\t.collection(&#x27;sections&#x27;)\n\t\t\t.findOne({ _id: new ObjectId(sectionId) });\n\t\texpect(section.deletedAt).not.be.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;802616f5-39e3-4ed1-9533-984e2be860b2&quot;,&quot;parentUUID&quot;:&quot;fdac8cd6-c61a-4eaf-b25f-a52d4215e7da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;802616f5-39e3-4ed1-9533-984e2be860b2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0320d342-ac6d-46b0-972b-420245453d77&quot;,&quot;title&quot;:&quot; translator system &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; translator system  \&quot;before all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:486,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d8a69af-c9ce-4441-8209-84da3de01e87&quot;,&quot;parentUUID&quot;:&quot;0320d342-ac6d-46b0-972b-420245453d77&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;fullTitle&quot;:&quot; translator system  \&quot;after all\&quot; hook in \&quot; translator system \&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;translators&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42c55ae8-162c-4b9b-9f6e-a5d8fe3dcabc&quot;,&quot;parentUUID&quot;:&quot;0320d342-ac6d-46b0-972b-420245453d77&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;bcfeffab-97a5-4b9c-be6e-431a737adadf&quot;,&quot;title&quot;:&quot; POST \&quot;/translator/\&quot; Create new translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should create new translator in database &quot;,&quot;fullTitle&quot;:&quot; translator system   POST \&quot;/translator/\&quot; Create new translator   Should create new translator in database &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newTranslator = {\n\tfullName: &#x27;Anna Petrova&#x27;,\n\tbooks: []\n};\nconst expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.post(&#x27;/translator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newTranslator)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(201);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t\ttranslatorId = response.body._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14291e09-a4bf-4aba-be2e-e8420ba54a02&quot;,&quot;parentUUID&quot;:&quot;bcfeffab-97a5-4b9c-be6e-431a737adadf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;14291e09-a4bf-4aba-be2e-e8420ba54a02&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c77ded0c-ebfe-432b-9daa-ace52ae29546&quot;,&quot;title&quot;:&quot; GET \&quot;/translator/\&quot; Get all translators &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return all translators &quot;,&quot;fullTitle&quot;:&quot; translator system   GET \&quot;/translator/\&quot; Get all translators   Should return all translators &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/translator/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10395fd5-92f2-4ca2-9697-1138c423ce8d&quot;,&quot;parentUUID&quot;:&quot;c77ded0c-ebfe-432b-9daa-ace52ae29546&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;10395fd5-92f2-4ca2-9697-1138c423ce8d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ca0c6858-b162-46fc-85fc-156817874a89&quot;,&quot;title&quot;:&quot; GET \&quot;/translator/:id\&quot; Get one translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one translator by id &quot;,&quot;fullTitle&quot;:&quot; translator system   GET \&quot;/translator/:id\&quot; Get one translator   Should return one translator by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;fullName&#x27;,\n\t&#x27;books&#x27;,\n\t&#x27;_id&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;\n];\nawait request(app)\n\t.get(`/translator/${translatorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;04cef8fe-c417-4b20-8fe4-90053e6c8516&quot;,&quot;parentUUID&quot;:&quot;ca0c6858-b162-46fc-85fc-156817874a89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;04cef8fe-c417-4b20-8fe4-90053e6c8516&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8f1890a5-9811-4728-96e5-1168d7b635d8&quot;,&quot;title&quot;:&quot; PATCH \&quot;/translator/:id\&quot; Update one existing translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return one translator with updated data &quot;,&quot;fullTitle&quot;:&quot; translator system   PATCH \&quot;/translator/:id\&quot; Update one existing translator   Should return one translator with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updatedTranslatorData = {\n\tfullName: &#x27;Updated translator name&#x27;\n};\nawait request(app)\n\t.patch(`/translator/${translatorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(updatedTranslatorData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.fullName).to.be.equal(\n\t\t\t&#x27;Updated translator name&#x27;\n\t\t);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;510d5fbe-c929-4557-997f-04360e046023&quot;,&quot;parentUUID&quot;:&quot;8f1890a5-9811-4728-96e5-1168d7b635d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;510d5fbe-c929-4557-997f-04360e046023&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8cfc9283-8fc2-4b4d-9e9a-c10ba3c67675&quot;,&quot;title&quot;:&quot; DELETE \&quot;/translator/:id\&quot; Delete one translator &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\translator-test.js&quot;,&quot;file&quot;:&quot;\\test\\translator-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark translator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;fullTitle&quot;:&quot; translator system   DELETE \&quot;/translator/:id\&quot; Delete one translator   Should mark translator as deleted via the \&quot;deletedAt\&quot; field, but not delete &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.delete(`/translator/${translatorId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.be.equal(204);\n\t\tconst deletedTranslator = await mongoose.connection\n\t\t\t.collection(&#x27;translators&#x27;)\n\t\t\t.findOne({});\n\t\texpect(deletedTranslator.deletedAt).to.be.not.null;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b75f3a9d-25fc-4eda-8ddc-6b1caf8282d0&quot;,&quot;parentUUID&quot;:&quot;8cfc9283-8fc2-4b4d-9e9a-c10ba3c67675&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b75f3a9d-25fc-4eda-8ddc-6b1caf8282d0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;405d2bad-740e-4f7a-960d-0c419e33e6f1&quot;,&quot;title&quot;:&quot;user system&quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;fullTitle&quot;:&quot;user system \&quot;before all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:503,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose\n\t.connect(process.env.TEST_CONNECTION_STRING)\n\t.catch(err =&gt; {\n\t\tconsole.log(`Failed to connect to database: ${err.message}`);\n\t});\n//#region add admin user to db and take token\nawait request(app).post(&#x27;/signup&#x27;).send(adminUser);\nawait mongoose.connection\n\t.collection(&#x27;users&#x27;)\n\t.updateOne(\n\t\t{ email: adminUser.email },\n\t\t{ $set: { role: &#x27;admin&#x27; } }\n\t);\nconst userData = {\n\tlogin: adminUser.email,\n\tpassword: adminUser.password\n};\nuserToken += (await request(app).post(&#x27;/login&#x27;).send(userData))\n\t.body.token;\n//#endregion&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f1ee34e-0ea6-464c-925c-a94fc4c913f6&quot;,&quot;parentUUID&quot;:&quot;405d2bad-740e-4f7a-960d-0c419e33e6f1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;fullTitle&quot;:&quot;user system \&quot;after all\&quot; hook in \&quot;user system\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mongoose.connection.collection(&#x27;products&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;producttypes&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;sections&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;users&#x27;).deleteMany();\nawait mongoose.connection.collection(&#x27;carts&#x27;).deleteMany();\nawait mongoose.connection.close();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f4039c2-26b9-4c39-96d4-cff3ca03d787&quot;,&quot;parentUUID&quot;:&quot;405d2bad-740e-4f7a-960d-0c419e33e6f1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;7d2563ab-544d-4152-9c8a-a187d5db92e3&quot;,&quot;title&quot;:&quot; GET \&quot;/user/\&quot; Get all users &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return an array of users &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/\&quot; Get all users   Should return an array of users &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(&#x27;/user/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t\tuserId = response.body[0]._id;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;53efa207-79ac-4508-baa3-a6e49eff202a&quot;,&quot;parentUUID&quot;:&quot;7d2563ab-544d-4152-9c8a-a187d5db92e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;53efa207-79ac-4508-baa3-a6e49eff202a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;11439663-199f-4dab-87c2-48dfe5b6718b&quot;,&quot;title&quot;:&quot; GET \&quot;/user/:id\&quot; Get one user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return user by id &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/:id\&quot; Get one user   Should return user by id &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;_id&#x27;,\n\t&#x27;firstName&#x27;,\n\t&#x27;lastName&#x27;,\n\t&#x27;phoneNumber&#x27;,\n\t&#x27;email&#x27;,\n\t&#x27;role&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;wishlist&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;cart&#x27;\n];\nawait request(app)\n\t.get(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24b9bd3e-8537-4202-a995-49aa9623d2a2&quot;,&quot;parentUUID&quot;:&quot;11439663-199f-4dab-87c2-48dfe5b6718b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;24b9bd3e-8537-4202-a995-49aa9623d2a2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a73f5b2d-d47a-4560-8140-e914ac6c9229&quot;,&quot;title&quot;:&quot; PATCH \&quot;/user/:id\&quot; Update one existing user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return the user with updated data &quot;,&quot;fullTitle&quot;:&quot;user system  PATCH \&quot;/user/:id\&quot; Update one existing user   Should return the user with updated data &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newData = {\n\tfirstName: &#x27;Артем&#x27;,\n\tlastName: &#x27;Желіковський&#x27;\n};\nawait request(app)\n\t.patch(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(newData)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body.firstName).to.equal(newData.firstName);\n\t\texpect(response.body.lastName).to.equal(newData.lastName);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75739b5c-024f-4574-8a00-b9a8acad11b5&quot;,&quot;parentUUID&quot;:&quot;a73f5b2d-d47a-4560-8140-e914ac6c9229&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;75739b5c-024f-4574-8a00-b9a8acad11b5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a9504846-75a9-4690-a013-0945e0377707&quot;,&quot;title&quot;:&quot; DELETE \&quot;/user/:id\&quot; Delete one user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should mark the user as deleted via the \&quot;deletedAt\&quot; field, but not delete him &quot;,&quot;fullTitle&quot;:&quot;user system  DELETE \&quot;/user/:id\&quot; Delete one user   Should mark the user as deleted via the \&quot;deletedAt\&quot; field, but not delete him &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const newUser = {\n\tfirstName: &#x27;Oleg&#x27;,\n\tlastName: &#x27;Smirniv&#x27;,\n\tphoneNumber: &#x27;380957846372&#x27;,\n\temail: &#x27;lahefi3700@devswp.com&#x27;,\n\tpassword: &#x27;41424344&#x27;,\n\trole: &#x27;user&#x27;\n};\nconst userId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;users&#x27;)\n\t\t.insertOne(newUser)\n).insertedId.toString();\nawait request(app)\n\t.delete(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(async () =&gt; {\n\t\tconst deletedUser = await mongoose.connection\n\t\t\t.collection(&#x27;users&#x27;)\n\t\t\t.findOne({ email: &#x27;lahefi3700@devswp.com&#x27; });\n\t\texpect(deletedUser).to.include.keys(&#x27;deletedAt&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ea899df3-02ec-4501-9638-656e546a9ff0&quot;,&quot;parentUUID&quot;:&quot;a9504846-75a9-4690-a013-0945e0377707&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ea899df3-02ec-4501-9638-656e546a9ff0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f95cb952-181a-4c10-9636-d9ad365e0889&quot;,&quot;title&quot;:&quot; GET \&quot;/user/account\&quot; Get user account &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return information about the authorized user &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/account\&quot; Get user account   Should return information about the authorized user &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const expectedFields = [\n\t&#x27;_id&#x27;,\n\t&#x27;firstName&#x27;,\n\t&#x27;lastName&#x27;,\n\t&#x27;phoneNumber&#x27;,\n\t&#x27;email&#x27;,\n\t&#x27;role&#x27;,\n\t&#x27;reviews&#x27;,\n\t&#x27;wishlist&#x27;,\n\t&#x27;createdAt&#x27;,\n\t&#x27;updatedAt&#x27;,\n\t&#x27;cart&#x27;\n];\nawait request(app)\n\t.get(`/user/${userId}`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.include.keys(...expectedFields);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e2bd182-b3f2-42c7-9bf3-965807811bcd&quot;,&quot;parentUUID&quot;:&quot;f95cb952-181a-4c10-9636-d9ad365e0889&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9e2bd182-b3f2-42c7-9bf3-965807811bcd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5d6ad73a-68db-492f-a185-08e307738093&quot;,&quot;title&quot;:&quot; POST \&quot;/user/wishlist/\&quot; Add product to user&#x27;s wishlist &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should add product to wishlist &quot;,&quot;fullTitle&quot;:&quot;user system  POST \&quot;/user/wishlist/\&quot; Add product to user&#x27;s wishlist   Should add product to wishlist &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//#region adding the necessary objects to the database\nconst productType = {\n\tname: &#x27;Книга&#x27;,\n\tkey: &#x27;book&#x27;\n};\nconst productTypeId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;producttypes&#x27;)\n\t\t.insertOne(productType)\n).insertedId;\nconst section = {\n\tname: &#x27;Фантастика&#x27;,\n\tkey: &#x27;fantastic&#x27;,\n\tproducts: [],\n\tsections: []\n};\nconst sectionId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;sections&#x27;)\n\t\t.insertOne(section)\n).insertedId;\nconst product = {\n\tname: &#x27;Збірка українських поезій&#x27;,\n\ttype: productTypeId,\n\tprice: 99.99,\n\tquantity: 10,\n\tdescription:\n\t\t&#x27;\&quot;Збірка українських поезій\&quot; - поетичний скарб, що втілює красу та духовність української літератури.&#x27;,\n\timages: [&#x27;image1.png&#x27;],\n\tsections: [sectionId],\n\tmodel: &#x27;Book&#x27;\n};\nproductId = (\n\tawait mongoose.connection\n\t\t.collection(&#x27;products&#x27;)\n\t\t.insertOne(product)\n).insertedId;\n//#endregion\nconst requestBody = {\n\tproduct: productId\n};\nawait request(app)\n\t.post(&#x27;/user/wishlist&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(requestBody)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst userWishlist = (\n\t\t\tawait mongoose.connection.collection(&#x27;users&#x27;).findOne()\n\t\t).wishlist;\n\t\texpect(\n\t\t\tuserWishlist.map(obj =&gt; obj.toString())\n\t\t).to.be.include(productId.toString());\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c41e9b5-24eb-45e5-9d77-818ee680dbc8&quot;,&quot;parentUUID&quot;:&quot;5d6ad73a-68db-492f-a185-08e307738093&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5c41e9b5-24eb-45e5-9d77-818ee680dbc8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5a7f7579-cd02-41ef-8d0d-fdf65bfec31a&quot;,&quot;title&quot;:&quot; DELETE \&quot;/user/wishlist/\&quot; Remove product from user&#x27;s wishlist &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Must remove product from wishlist &quot;,&quot;fullTitle&quot;:&quot;user system  DELETE \&quot;/user/wishlist/\&quot; Remove product from user&#x27;s wishlist   Must remove product from wishlist &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const requestBody = {\n\tproduct: productId\n};\nawait request(app)\n\t.delete(&#x27;/user/wishlist/&#x27;)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.send(requestBody)\n\t.then(async response =&gt; {\n\t\texpect(response.status).to.equal(204);\n\t\tconst userWishlist = (\n\t\t\tawait mongoose.connection.collection(&#x27;users&#x27;).findOne()\n\t\t).wishlist;\n\t\texpect(userWishlist).to.be.empty;\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0d46418-d040-41e6-8bd0-200870a345b7&quot;,&quot;parentUUID&quot;:&quot;5a7f7579-cd02-41ef-8d0d-fdf65bfec31a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c0d46418-d040-41e6-8bd0-200870a345b7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;19085c63-edac-4df0-adee-ea85b71bf3f3&quot;,&quot;title&quot;:&quot; GET \&quot;/user/orders/\&quot; Get all orders made by user &quot;,&quot;fullFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\test\\user-test.js&quot;,&quot;file&quot;:&quot;\\test\\user-test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot; Should return an array of orders &quot;,&quot;fullTitle&quot;:&quot;user system  GET \&quot;/user/orders/\&quot; Get all orders made by user   Should return an array of orders &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n\t.get(`/user/orders/`)\n\t.set(&#x27;Authorization&#x27;, userToken)\n\t.then(response =&gt; {\n\t\texpect(response.status).to.equal(200);\n\t\texpect(response.header[&#x27;content-type&#x27;]).to.include(\n\t\t\t&#x27;application/json&#x27;\n\t\t);\n\t\texpect(response.body).to.be.an(&#x27;array&#x27;);\n\t});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81b73b53-e4b0-4a38-a622-e98b4637b087&quot;,&quot;parentUUID&quot;:&quot;19085c63-edac-4df0-adee-ea85b71bf3f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;81b73b53-e4b0-4a38-a622-e98b4637b087&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.2.0&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;api&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\mochawesome-report\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;D:\\Historium Projects\\main branch\\api\\mochawesome-report\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>